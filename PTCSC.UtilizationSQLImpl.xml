<?xml version="1.0" encoding="UTF-8" standalone="no"?><Entities build="b313" majorVersion="9" minorVersion="4" modelPersistenceProviderPackage="MssqlPersistenceProviderPackage" revision="1" schemaVersion="1140" universal=""><StyleDefinitions/><Networks/><PersistenceProviderPackages/><Mashups/><ScriptFunctionLibraries/><Projects><Project artifactId="" aspect.projectType="Component" dependsOn="{&quot;extensions&quot;:&quot;PTC.Base:1.2.1&quot;,&quot;projects&quot;:&quot;PTCSC.Utilization:1.0.0&quot;}" description="" documentationContent="" groupId="" homeMashup="" lastModifiedDate="2023-11-01T13:36:32.994Z" minPlatformVersion="" name="PTCSC.UtilizationSQLImpl" packageVersion="1.0.0" projectName="PTCSC.UtilizationSQLImpl" publishResult="" state="DRAFT" tags=""><Owner name="Administrator" type="User"/><avatar/><DesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></DesignTimePermissions><RunTimePermissions/><VisibilityPermissions><Visibility><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_OR" type="Organization"/><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_OR:PTCSC.UtilizationSQLImpl.Admin_UG" type="OrganizationalUnit"/></Visibility></VisibilityPermissions><ConfigurationTableDefinitions/><ConfigurationTables/><ConfigurationChanges><ConfigurationChange changeAction="CREATE" changeReason="Created Programmatically" timestamp="2022-11-01T15:09:34.381Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:24.579Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:24.582Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:34.435Z" user="Administrator"/><ConfigurationChange changeAction="DELETE" changeReason="DeleteVisibilityPermissions" timestamp="2023-02-07T20:21:34.439Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:40.509Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:40.512Z" user="Administrator"/><ConfigurationChange changeAction="CREATE" changeReason="" timestamp="2023-11-01T13:36:32.994Z" user="Administrator"/></ConfigurationChanges></Project></Projects><Users/><DirectoryServices/><Widgets/><MediaEntities/><Groups><Group description="" documentationContent="" homeMashup="" lastModifiedDate="2023-11-01T13:36:32.936Z" name="PTCSC.UtilizationSQLImpl.Admin_UG" projectName="PTCSC.UtilizationSQLImpl" scimDisplayName="" scimExternalId="" scimId="" tags=""><Owner name="Administrator" type="User"/><avatar/><DesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></DesignTimePermissions><RunTimePermissions/><VisibilityPermissions><Visibility><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_OR" type="Organization"/><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_OR:PTCSC.UtilizationSQLImpl.Admin_UG" type="OrganizationalUnit"/></Visibility></VisibilityPermissions><ConfigurationTableDefinitions/><ConfigurationTables/><Members><Members><Member name="PTCDTS.Base.Permissions.ApplicationAdmin_UG" type="Group"/></Members></Members><ConfigurationChanges><ConfigurationChange changeAction="CREATE" changeReason="Created Programmatically" timestamp="2022-11-01T15:09:34.640Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="SetProjectName : [PTCSC.UtilizationSQLImpl]" timestamp="2022-11-01T15:09:34.666Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:24.585Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:24.588Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:34.442Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:34.447Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:40.516Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:40.521Z" user="Administrator"/><ConfigurationChange changeAction="CREATE" changeReason="" timestamp="2023-11-01T13:36:32.936Z" user="Administrator"/></ConfigurationChanges></Group><Group description="" documentationContent="" homeMashup="" lastModifiedDate="2023-11-01T13:36:32.939Z" name="PTCSC.UtilizationSQLImpl.Default_UG" projectName="PTCSC.UtilizationSQLImpl" scimDisplayName="" scimExternalId="" scimId="" tags=""><Owner name="Administrator" type="User"/><avatar/><DesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></DesignTimePermissions><RunTimePermissions/><VisibilityPermissions><Visibility><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_OR" type="Organization"/><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_OR:PTCSC.UtilizationSQLImpl.Admin_UG" type="OrganizationalUnit"/></Visibility></VisibilityPermissions><ConfigurationTableDefinitions/><ConfigurationTables/><Members><Members><Member name="PTCDTS.Base.Permissions.Default_UG" type="Group"/></Members></Members><ConfigurationChanges><ConfigurationChange changeAction="CREATE" changeReason="Created Programmatically" timestamp="2022-11-01T15:09:34.628Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="SetProjectName : [PTCSC.UtilizationSQLImpl]" timestamp="2022-11-01T15:09:34.662Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:24.599Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:24.602Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:34.460Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:34.463Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:40.532Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:40.537Z" user="Administrator"/><ConfigurationChange changeAction="CREATE" changeReason="" timestamp="2023-11-01T13:36:32.939Z" user="Administrator"/></ConfigurationChanges></Group></Groups><PersistenceProviders/><ModelTags/><LocalizationTables/><Dashboards/><StyleThemes/><DataShapes><DataShape baseDataShape="" description="" documentationContent="" homeMashup="" lastModifiedDate="2023-12-07T19:47:32.138Z" name="PTCSC.UtilizationSQLImpl.Config_DS" projectName="PTCSC.UtilizationSQLImpl" tags=""><Owner name="Administrator" type="User"/><avatar/><DesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></DesignTimePermissions><RunTimePermissions/><VisibilityPermissions><Visibility/></VisibilityPermissions><ConfigurationTableDefinitions/><ConfigurationTables/><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="true" baseType="INTEGER" description="" name="DaysToKeepWhenPurging" ordinal="1"/><FieldDefinition aspect.isPrimaryKey="false" baseType="INTEGER" description="" name="HoursToLookBackOnUtilScreens" ordinal="2"/><FieldDefinition aspect.isPrimaryKey="false" baseType="INTEGER" description="Utilization screen refresh rate (seconds)" name="ScreenRefreshRate" ordinal="3"/><FieldDefinition aspect.isPrimaryKey="false" baseType="INTEGER" description="" name="UtilizationCriticalPercent" ordinal="4"/><FieldDefinition aspect.isPrimaryKey="false" baseType="INTEGER" description="" name="UtilizationWarningPercent" ordinal="5"/></FieldDefinitions><ConfigurationChanges><ConfigurationChange changeAction="CREATE" changeReason="header : projectName : updated, name : updated&#10;" timestamp="2023-11-02T12:47:35.280Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="fields : ScreenRefreshRate : added&#10;" timestamp="2023-12-07T16:16:03.309Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="fields : Critical : added, Warning : added&#10;" timestamp="2023-12-07T19:46:19.728Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="fields : Critical : deleted, Warning : deleted, UtilizationCriticalPercent : added, UtilizationWarningPercent : added&#10;" timestamp="2023-12-07T19:47:32.138Z" user="Administrator"/></ConfigurationChanges></DataShape></DataShapes><Things><Thing aspect.isSystemObject="false" description="Implementation of PTCSC&gt;utilization using SQL data objects" documentationContent="" effectiveThingPackage="ConfiguredThing" enabled="true" homeMashup="" identifier="" inheritedValueStream="" lastModifiedDate="2023-12-11T22:03:45.068Z" name="PTCSC.UtilizationSQLImpl.EntryPoint" projectName="PTCSC.UtilizationSQLImpl" published="false" tags="" thingTemplate="PTCSC.UtilizationSQLImpl.EntryPoint_TT" valueStream=""><Owner name="Administrator" type="User"/><avatar/><DesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></DesignTimePermissions><RunTimePermissions><Permissions resourceName="*"><PropertyRead/><PropertyWrite/><ServiceInvoke><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Admin_UG" type="Group"/></ServiceInvoke><EventInvoke/><EventSubscribe/></Permissions></RunTimePermissions><VisibilityPermissions><Visibility><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_OR" type="Organization"/><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_OR:PTCSC.UtilizationSQLImpl.Admin_UG" type="OrganizationalUnit"/></Visibility></VisibilityPermissions><ConfigurationTableDefinitions/><ConfigurationTables><ConfigurationTable dataShapeName="" description="Configuration table to store the components core manager" isMultiRow="true" name="ComponentManager" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="true" baseType="STRING" description="unique identifier for the manager that needs to be configured" name="id" ordinal="1"/><FieldDefinition aspect.isPrimaryKey="false" aspect.thingShape="PTC.Base.CommonManagement_TS" baseType="THINGNAME" description="Name of the Manager Thing to be configured" name="managerThingName" ordinal="2"/></FieldDefinitions></DataShape><Rows><Row><id><![CDATA[ComponentManager]]></id><managerThingName><![CDATA[PTCSC.UtilizationSQLImpl.Manager]]></managerThingName></Row></Rows></ConfigurationTable></ConfigurationTables><ThingShape><PropertyDefinitions/><ServiceDefinitions/><EventDefinitions/><ServiceMappings/><ServiceImplementations><ServiceImplementation description="" handlerName="Script" name="DeployComponent"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[// Populate configuration tables with initial data
Things["PTCSC.UtilizationSQLImpl.Manager"].AddOrUpdateInitialReasonData();
Things["PTCSC.UtilizationSQLImpl.Manager"].AddOrUpdateInitialReasonGroupData();
Things["PTCSC.UtilizationSQLImpl.Manager"].AddOrUpdateInitialUtilizationStateData();

// grab the configuration table
let table = Things["PTC.Base.Manager"].GetConfigurationTable({
	tableName: "DefaultGlobalManagerConfiguration" /* STRING */
});

// iterate the configuration table
var insertNewRow = true;
// if the uitlization row exists, update it
table.rows.toArray().forEach(row => {
    //Your code here
    if (row.id == "PTCSC.Utilization.Manager"){
        row.managerThingName = "PTCSC.UtilizationSQLImpl.Manager";
        insertNewRow = false;
    }
});

// if the utilization row does not exist, add it
if (insertNewRow == true){
    var newRow = {};
    newRow.id = "PTCSC.Utilization.Manager";
    newRow.managerThingName = "PTCSC.UtilizationSQLImpl.Manager";
    table.AddRow(newRow);
}

// set the configuration table
Things["PTC.Base.Manager"].SetMultiRowConfigurationTable({
	configurationTable: table /* INFOTABLE */,
	persistent: true /* BOOLEAN {"defaultValue":true} */,
	tableName: "DefaultGlobalManagerConfiguration" /* STRING */
});

// Return true as a default
var result = true;]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation></ServiceImplementations><Subscriptions/></ThingShape><PropertyBindings/><RemotePropertyBindings/><RemoteServiceBindings/><RemoteEventBindings/><AlertConfigurations/><ImplementedShapes/><ThingProperties><componentType><Value><![CDATA[Implementation]]></Value><Timestamp>2022-11-01T15:09:34.598Z</Timestamp><Quality>GOOD</Quality></componentType><componentDeploymentState><Value><![CDATA[Configured]]></Value><Timestamp>2023-11-29T20:08:13.303Z</Timestamp><Quality>GOOD</Quality></componentDeploymentState><componentDefaultOrg><Value><![CDATA[PTCSC.UtilizationSQLImpl.Default_OR]]></Value><Timestamp>2022-11-01T15:09:34.597Z</Timestamp><Quality>GOOD</Quality></componentDefaultOrg><dependentComponents><Value><infoTable><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="Common name of the component" name="ComponentName" ordinal="0"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="Component's project name" name="ComponentProjectName" ordinal="0"/></FieldDefinitions></DataShape><Rows/></infoTable></Value><Timestamp>2023-11-01T13:36:33.112Z</Timestamp><Quality>GOOD</Quality></dependentComponents><deployComponentStatus><Value><infoTable><DataShape><FieldDefinitions><FieldDefinition aspect.defaultValue="{}" aspect.isPrimaryKey="false" baseType="JSON" description="Information about the internal status." name="additionalInfo" ordinal="0"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="Name of the Component" name="name" ordinal="0"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="config status of the component" name="status" ordinal="0"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="Type of action." name="type" ordinal="0"/></FieldDefinitions></DataShape><Rows/></infoTable></Value><Timestamp>2023-11-01T13:36:33.112Z</Timestamp><Quality>GOOD</Quality></deployComponentStatus><componentDescription><Value><![CDATA[Implementation of PTCSC>utilization using SQL data objects]]></Value><Timestamp>2022-11-01T15:09:34.598Z</Timestamp><Quality>GOOD</Quality></componentDescription><migrateComponentStatus><Value><infoTable><DataShape><FieldDefinitions><FieldDefinition aspect.defaultValue="{}" aspect.isPrimaryKey="false" baseType="JSON" description="Information about the internal status." name="additionalInfo" ordinal="0"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="Name of the Component" name="name" ordinal="0"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="config status of the component" name="status" ordinal="0"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="Type of action." name="type" ordinal="0"/></FieldDefinitions></DataShape><Rows/></infoTable></Value><Timestamp>2023-11-01T13:36:33.112Z</Timestamp><Quality>GOOD</Quality></migrateComponentStatus><componentDefaultUserGroup><Value><![CDATA[PTCSC.UtilizationSQLImpl.Default_UG]]></Value><Timestamp>2022-11-01T15:09:34.597Z</Timestamp><Quality>GOOD</Quality></componentDefaultUserGroup><componentThumbnail><Value/><Timestamp>2023-11-01T13:36:33.112Z</Timestamp><Quality>GOOD</Quality></componentThumbnail><componentVersion><Value><![CDATA[1.0.1]]></Value><Timestamp>2023-12-11T22:03:43.133Z</Timestamp><Quality>GOOD</Quality></componentVersion><componentMainMashup><Value/><Timestamp>2023-11-01T13:36:33.112Z</Timestamp><Quality>GOOD</Quality></componentMainMashup><componentName><Value><![CDATA[PTCSC.UtilizationSQLImpl]]></Value><Timestamp>2022-11-01T15:09:34.598Z</Timestamp><Quality>GOOD</Quality></componentName><upgradeComponentStatus><Value><infoTable><DataShape><FieldDefinitions><FieldDefinition aspect.defaultValue="{}" aspect.isPrimaryKey="false" baseType="JSON" description="Information about the internal status." name="additionalInfo" ordinal="0"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="Name of the Component" name="name" ordinal="0"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="config status of the component" name="status" ordinal="0"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="Type of action." name="type" ordinal="0"/></FieldDefinitions></DataShape><Rows/></infoTable></Value><Timestamp>2023-11-01T13:36:33.112Z</Timestamp><Quality>GOOD</Quality></upgradeComponentStatus></ThingProperties><ConfigurationChanges><ConfigurationChange changeAction="CREATE" changeReason="" timestamp="2023-11-01T13:36:32.997Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : DeployComponent : service added&#10;" timestamp="2023-12-01T01:48:04.010Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : DeployComponent : service updated&#10;" timestamp="2023-12-04T23:18:08.312Z" user="Administrator"/></ConfigurationChanges></Thing><Thing aspect.isSystemObject="false" description="Implementation of PTCSC&gt;utilization using SQL data objects" documentationContent="" effectiveThingPackage="ConfiguredThing" enabled="true" homeMashup="" identifier="" inheritedValueStream="" lastModifiedDate="2023-12-07T19:50:41.635Z" name="PTCSC.UtilizationSQLImpl.Manager" projectName="PTCSC.UtilizationSQLImpl" published="false" tags="" thingTemplate="PTCSC.UtilizationSQLImpl.Manager_TT" valueStream=""><Owner name="Administrator" type="User"/><avatar/><DesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></DesignTimePermissions><RunTimePermissions><Permissions resourceName="*"><PropertyRead/><PropertyWrite/><ServiceInvoke><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Admin_UG" type="Group"/><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_UG" type="Group"/></ServiceInvoke><EventInvoke/><EventSubscribe/></Permissions></RunTimePermissions><VisibilityPermissions><Visibility><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_OR" type="Organization"/><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_OR:PTCSC.UtilizationSQLImpl.Admin_UG" type="OrganizationalUnit"/></Visibility></VisibilityPermissions><ConfigurationTableDefinitions/><ConfigurationTables><ConfigurationTable dataShapeName="" description="Configuration table used to identify managers that the building block should use" isMultiRow="true" name="ManagerConfiguration" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="true" baseType="STRING" description="unique identifier for the manager that needs to be configured" name="id" ordinal="1"/><FieldDefinition aspect.isPrimaryKey="false" aspect.thingShape="PTC.Base.CommonManagement_TS" baseType="THINGNAME" description="Name of the Manager Thing to be configured" name="managerThingName" ordinal="2"/></FieldDefinitions></DataShape><Rows/></ConfigurationTable><ConfigurationTable dataShapeName="" description="" isMultiRow="true" name="MashupConfiguration" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="true" baseType="STRING" description="unique identifier used to identify the thing or mashup that is being configured" name="id" ordinal="1"/><FieldDefinition aspect.isPrimaryKey="false" baseType="MASHUPNAME" description="name of the mashup to configure" name="mashupName" ordinal="2"/></FieldDefinitions></DataShape><Rows/></ConfigurationTable><ConfigurationTable dataShapeName="" description="Configuration table for dynamic menus. Menu Items can be specified here and they will show up for the given menu name. " isMultiRow="true" name="MenuConfiguration" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="" name="menuItemMashupName" ordinal="2"/><FieldDefinition aspect.isPrimaryKey="true" baseType="STRING" description="" name="menuName" ordinal="3"/><FieldDefinition aspect.isPrimaryKey="false" baseType="INTEGER" description="An optional field to indicate the ordering of the menu items" name="menuOrderPreference" ordinal="5"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="Localization table key for the optional section that groups like menus together" name="menuSectionKey" ordinal="4"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="Localization table key for the menu label" name="menuTitleKey" ordinal="1"/><FieldDefinition aspect.dataShape="PTC.Base.ComponentMenuConfiguration" aspect.isPrimaryKey="false" baseType="INFOTABLE" description="" name="submenu" ordinal="6"/></FieldDefinitions></DataShape><Rows/></ConfigurationTable><ConfigurationTable dataShapeName="" description="Configuration table for any Things that need to be configured. This allows for OOTB things to be customized, and the new version that should be used can be configured here" isMultiRow="true" name="ThingConfiguration" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="true" baseType="STRING" description="unique identifier used to identify the thing or mashup that is being configured" name="id" ordinal="1"/><FieldDefinition aspect.isPrimaryKey="false" baseType="THINGNAME" description="Name of the Thing entity or Mashup entity that is to be configured" name="thingName" ordinal="2"/></FieldDefinitions></DataShape><Rows/></ConfigurationTable><ConfigurationTable dataShapeName="" description="General configuration for the Utilization Application" isMultiRow="false" name="UtilizationConfiguration" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="true" baseType="INTEGER" description="" name="DaysToKeepWhenPurging" ordinal="1"/><FieldDefinition aspect.isPrimaryKey="false" baseType="INTEGER" description="" name="HoursToLookBackOnUtilScreens" ordinal="2"/><FieldDefinition aspect.isPrimaryKey="false" baseType="INTEGER" description="Utilization screen refresh rate (seconds)" name="ScreenRefreshRate" ordinal="3"/><FieldDefinition aspect.isPrimaryKey="false" baseType="INTEGER" description="" name="UtilizationCriticalPercent" ordinal="4"/><FieldDefinition aspect.isPrimaryKey="false" baseType="INTEGER" description="" name="UtilizationWarningPercent" ordinal="5"/></FieldDefinitions></DataShape><Rows><Row><DaysToKeepWhenPurging>7</DaysToKeepWhenPurging><HoursToLookBackOnUtilScreens>8</HoursToLookBackOnUtilScreens><ScreenRefreshRate>30</ScreenRefreshRate><UtilizationCriticalPercent>50</UtilizationCriticalPercent><UtilizationWarningPercent>63</UtilizationWarningPercent></Row></Rows></ConfigurationTable></ConfigurationTables><ThingShape><PropertyDefinitions/><ServiceDefinitions/><EventDefinitions/><ServiceMappings/><ServiceImplementations/><Subscriptions/></ThingShape><PropertyBindings/><RemotePropertyBindings/><RemoteServiceBindings/><RemoteEventBindings/><AlertConfigurations/><ImplementedShapes/><ThingProperties/><ConfigurationChanges><ConfigurationChange changeAction="CREATE" changeReason="" timestamp="2023-11-01T13:36:33.000Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="configuration : DaysToKeepWhenPurging : updated, HoursToLookBackOnUtilScreens : updated&#10;" timestamp="2023-11-02T13:06:33.293Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="configuration : HoursToLookBackOnUtilScreens : updated&#10;" timestamp="2023-11-02T15:24:42.656Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="configuration : HoursToLookBackOnUtilScreens : updated&#10;" timestamp="2023-11-02T15:25:05.504Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="configuration : ScreenRefreshRate : updated&#10;" timestamp="2023-12-07T16:17:18.542Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="configuration : UtilizationCriticalPercent : updated, UtilizationWarningPercent : updated&#10;" timestamp="2023-12-07T19:50:41.634Z" user="Administrator"/></ConfigurationChanges></Thing><Thing description="" documentationContent="" effectiveThingPackage="SQLThingPackage" enabled="true" homeMashup="" identifier="" inheritedValueStream="" lastModifiedDate="2023-11-01T13:53:06.564Z" name="PTCSC.UtilizationSQLImpl.SQLDatabase" projectName="PTCSC.UtilizationSQLImpl" published="false" tags="" thingTemplate="PTCSC.UtilizationSQLImpl.SQLDatabase_TT" valueStream=""><Owner name="Administrator" type="User"/><avatar/><DesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></DesignTimePermissions><RunTimePermissions><Permissions resourceName="*"><PropertyRead/><PropertyWrite/><ServiceInvoke><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Admin_UG" type="Group"/></ServiceInvoke><EventInvoke/><EventSubscribe/></Permissions></RunTimePermissions><VisibilityPermissions><Visibility><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_OR" type="Organization"/><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_OR:PTCSC.UtilizationSQLImpl.Admin_UG" type="OrganizationalUnit"/></Visibility></VisibilityPermissions><ConfigurationTableDefinitions/><ConfigurationTables><ConfigurationTable dataShapeName="" description="Connection Monitoring Settings" isMultiRow="false" name="ConnectionMonitoring" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.defaultValue="30000.0" aspect.friendlyName="Monitor Rate (milliseconds)" baseType="NUMBER" description="Monitor rate in milliseconds" name="connectionMonitorRate" ordinal="1"/><FieldDefinition aspect.defaultValue="false" aspect.friendlyName="Enable Monitoring" baseType="BOOLEAN" description="Enable connection monitoring" name="enableMonitor" ordinal="0"/><FieldDefinition aspect.defaultValue="1.0" aspect.friendlyName="Number of Retries" baseType="NUMBER" description="Number of retries" name="numberOfRetries" ordinal="2"/><FieldDefinition aspect.defaultValue="2000.0" aspect.friendlyName="Retry Delay (milliseconds)" baseType="NUMBER" description="Retry delay in milliseconds" name="retryDelay" ordinal="3"/></FieldDefinitions></DataShape><Rows><Row><connectionMonitorRate>30000.0</connectionMonitorRate><enableMonitor>false</enableMonitor><numberOfRetries>1.0</numberOfRetries><retryDelay>2000.0</retryDelay></Row></Rows></ConfigurationTable><ConfigurationTable dataShapeName="" description="Connection Provider" isMultiRow="false" name="ConnectionProvider" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.defaultValue="false" aspect.friendlyName="Participate in platform transactions" baseType="BOOLEAN" description="Participate in platform transactions" name="isTransactional" ordinal="0"/><FieldDefinition aspect.defaultValue="ThingworxPersistenceProvider" aspect.friendlyName="Persistence Provider Name" baseType="PERSISTENCEPROVIDERNAME" description="The Persistence Provider from which to retrieve connections" name="persistenceProviderName" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><isTransactional>false</isTransactional><persistenceProviderName><![CDATA[UtilizationPersistenceProvider]]></persistenceProviderName></Row></Rows></ConfigurationTable><ConfigurationTable dataShapeName="" description="Field/Column Name Aliases" isMultiRow="true" name="ColumnAliases" ordinal="1"><DataShape><FieldDefinitions><FieldDefinition aspect.friendlyName="Database Column Name" baseType="STRING" description="Database column name" name="columnName" ordinal="0"/><FieldDefinition aspect.friendlyName="Thingworx Field Name" baseType="STRING" description="Thingworx field name" name="fieldName" ordinal="1"/></FieldDefinitions></DataShape><Rows/></ConfigurationTable></ConfigurationTables><ThingShape><PropertyDefinitions/><ServiceDefinitions/><EventDefinitions/><ServiceMappings/><ServiceImplementations/><Subscriptions/></ThingShape><PropertyBindings/><RemotePropertyBindings/><RemoteServiceBindings/><RemoteEventBindings/><AlertConfigurations/><ImplementedShapes/><ThingProperties/><ConfigurationChanges><ConfigurationChange changeAction="CREATE" changeReason="" timestamp="2023-11-01T13:36:32.999Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="configuration : persistenceProviderName : updated&#10;" timestamp="2023-11-01T13:53:06.561Z" user="Administrator"/></ConfigurationChanges></Thing></Things><Logs/><Authenticators/><ThingPackages/><NotificationDefinitions/><ApplicationKeys/><StateDefinitions/><ThingTemplates><ThingTemplate baseThingTemplate="SQLThing" description="" documentationContent="" effectiveThingPackage="SQLThingPackage" homeMashup="" inheritedValueStream="" lastModifiedDate="2023-11-01T13:36:32.980Z" name="PTCSC.UtilizationSQLImpl.SQLDatabase_TT" projectName="PTCSC.UtilizationSQLImpl" tags="" thingPackage="" valueStream=""><Owner name="Administrator" type="User"/><avatar/><DesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></DesignTimePermissions><RunTimePermissions/><VisibilityPermissions><Visibility><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_OR" type="Organization"/><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_OR:PTCSC.UtilizationSQLImpl.Admin_UG" type="OrganizationalUnit"/></Visibility></VisibilityPermissions><ConfigurationTableDefinitions/><ConfigurationTables><ConfigurationTable dataShapeName="" description="Connection Monitoring Settings" isMultiRow="false" name="ConnectionMonitoring" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.defaultValue="30000.0" aspect.friendlyName="Monitor Rate (milliseconds)" baseType="NUMBER" description="Monitor rate in milliseconds" name="connectionMonitorRate" ordinal="1"/><FieldDefinition aspect.defaultValue="false" aspect.friendlyName="Enable Monitoring" baseType="BOOLEAN" description="Enable connection monitoring" name="enableMonitor" ordinal="0"/><FieldDefinition aspect.defaultValue="1.0" aspect.friendlyName="Number of Retries" baseType="NUMBER" description="Number of retries" name="numberOfRetries" ordinal="2"/><FieldDefinition aspect.defaultValue="2000.0" aspect.friendlyName="Retry Delay (milliseconds)" baseType="NUMBER" description="Retry delay in milliseconds" name="retryDelay" ordinal="3"/></FieldDefinitions></DataShape><Rows><Row><connectionMonitorRate>30000.0</connectionMonitorRate><enableMonitor>false</enableMonitor><numberOfRetries>1.0</numberOfRetries><retryDelay>2000.0</retryDelay></Row></Rows></ConfigurationTable><ConfigurationTable dataShapeName="" description="Connection Provider" isMultiRow="false" name="ConnectionProvider" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.defaultValue="false" aspect.friendlyName="Participate in platform transactions" baseType="BOOLEAN" description="Participate in platform transactions" name="isTransactional" ordinal="0"/><FieldDefinition aspect.defaultValue="ThingworxPersistenceProvider" aspect.friendlyName="Persistence Provider Name" baseType="PERSISTENCEPROVIDERNAME" description="The Persistence Provider from which to retrieve connections" name="persistenceProviderName" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><isTransactional>false</isTransactional><persistenceProviderName><![CDATA[ThingworxPersistenceProvider]]></persistenceProviderName></Row></Rows></ConfigurationTable><ConfigurationTable dataShapeName="" description="Field/Column Name Aliases" isMultiRow="true" name="ColumnAliases" ordinal="1"><DataShape><FieldDefinitions><FieldDefinition aspect.friendlyName="Database Column Name" baseType="STRING" description="Database column name" name="columnName" ordinal="0"/><FieldDefinition aspect.friendlyName="Thingworx Field Name" baseType="STRING" description="Thingworx field name" name="fieldName" ordinal="1"/></FieldDefinitions></DataShape><Rows/></ConfigurationTable></ConfigurationTables><PropertyBindings/><RemotePropertyBindings/><RemoteServiceBindings/><RemoteEventBindings/><AlertConfigurations/><ThingShape><PropertyDefinitions/><ServiceDefinitions><ServiceDefinition aspect.isAsync="false" category="" description="" isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="AddOrUpdateMachineCode"><ResultType baseType="NUMBER" description="" name="result" ordinal="0"/><ParameterDefinitions><FieldDefinition baseType="STRING" description="" name="EquipmentID" ordinal="1"/><FieldDefinition baseType="INTEGER" description="" name="MachineCode" ordinal="2"/><FieldDefinition baseType="STRING" description="" name="Reason" ordinal="5"/><FieldDefinition baseType="STRING" description="" name="ReasonGroup" ordinal="4"/><FieldDefinition baseType="STRING" description="" name="UtilizationState" ordinal="3"/></ParameterDefinitions></ServiceDefinition><ServiceDefinition aspect.isAsync="false" category="" description="" isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="AddOrUpdateReason"><ResultType baseType="NUMBER" description="" name="result" ordinal="0"/><ParameterDefinitions><FieldDefinition baseType="BOOLEAN" description="" name="Failure" ordinal="5"/><FieldDefinition baseType="STRING" description="" name="Reason" ordinal="1"/><FieldDefinition baseType="STRING" description="" name="ReasonDescriotion" ordinal="4"/><FieldDefinition baseType="STRING" description="" name="ReasonGroup" ordinal="2"/><FieldDefinition baseType="STRING" description="" name="UtilizationState" ordinal="3"/></ParameterDefinitions></ServiceDefinition><ServiceDefinition aspect.isAsync="false" category="" description="" isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="AddOrUpdateReasonGroup"><ResultType baseType="NUMBER" description="" name="result" ordinal="0"/><ParameterDefinitions><FieldDefinition baseType="STRING" description="" name="ParentReasonGroup" ordinal="3"/><FieldDefinition baseType="STRING" description="" name="ReasonGroup" ordinal="1"/><FieldDefinition baseType="STRING" description="" name="ReasonGroupDescription" ordinal="2"/></ParameterDefinitions></ServiceDefinition><ServiceDefinition aspect.isAsync="false" category="" description="" isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="AddOrUpdateUtilizationRecord"><ResultType baseType="NUMBER" description="" name="result" ordinal="0"/><ParameterDefinitions><FieldDefinition baseType="STRING" description="" name="Comment" ordinal="9"/><FieldDefinition baseType="STRING" description="" name="EquipmentID" ordinal="2"/><FieldDefinition baseType="DATETIME" description="" name="ModifiedAt" ordinal="10"/><FieldDefinition baseType="STRING" description="" name="ModifiedBy" ordinal="11"/><FieldDefinition baseType="STRING" description="" name="OperatorID" ordinal="6"/><FieldDefinition baseType="STRING" description="" name="ProductID" ordinal="8"/><FieldDefinition baseType="STRING" description="" name="Reason" ordinal="5"/><FieldDefinition baseType="STRING" description="" name="ReasonGroup" ordinal="4"/><FieldDefinition baseType="STRING" description="" name="ShiftID" ordinal="7"/><FieldDefinition baseType="DATETIME" description="" name="Timestamp" ordinal="1"/><FieldDefinition baseType="STRING" description="" name="UtilizationState" ordinal="3"/></ParameterDefinitions></ServiceDefinition><ServiceDefinition aspect.isAsync="false" category="" description="" isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="AddOrUpdateUtilizationState"><ResultType baseType="NUMBER" description="" name="result" ordinal="0"/><ParameterDefinitions><FieldDefinition baseType="BOOLEAN" description="" name="IncludeInUtilizationCalculation" ordinal="4"/><FieldDefinition baseType="STRING" description="" name="UtilizationState" ordinal="1"/><FieldDefinition baseType="STRING" description="" name="UtilizationStateDescription" ordinal="2"/><FieldDefinition baseType="BOOLEAN" description="" name="Utilized" ordinal="3"/></ParameterDefinitions></ServiceDefinition><ServiceDefinition aspect.isAsync="false" category="" description="" isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="DeleteMachineCode"><ResultType baseType="NUMBER" description="" name="result" ordinal="0"/><ParameterDefinitions><FieldDefinition baseType="STRING" description="" name="EquipmentID" ordinal="1"/><FieldDefinition baseType="INTEGER" description="" name="MachineCode" ordinal="2"/></ParameterDefinitions></ServiceDefinition><ServiceDefinition aspect.isAsync="false" category="" description="" isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="DeleteReason"><ResultType baseType="NUMBER" description="" name="result" ordinal="0"/><ParameterDefinitions><FieldDefinition baseType="STRING" description="" name="Reason" ordinal="1"/></ParameterDefinitions></ServiceDefinition><ServiceDefinition aspect.isAsync="false" category="" description="" isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="DeleteReasonGroup"><ResultType baseType="NUMBER" description="" name="result" ordinal="0"/><ParameterDefinitions><FieldDefinition baseType="STRING" description="" name="ReasonGroup" ordinal="1"/></ParameterDefinitions></ServiceDefinition><ServiceDefinition aspect.isAsync="false" category="" description="" isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="DeleteUtilizationRecords"><ResultType baseType="NUMBER" description="" name="result" ordinal="0"/><ParameterDefinitions><FieldDefinition baseType="INTEGER" description="" name="DaysBackToRetain" ordinal="1"/></ParameterDefinitions></ServiceDefinition><ServiceDefinition aspect.isAsync="false" category="" description="" isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="DeleteUtilizationState"><ResultType baseType="NUMBER" description="" name="result" ordinal="0"/><ParameterDefinitions><FieldDefinition baseType="STRING" description="" name="UtilizationState" ordinal="1"/></ParameterDefinitions></ServiceDefinition><ServiceDefinition aspect.isAsync="false" category="" description="" isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="GetEventDataPriorToMachineTimeStamp"><ResultType aspect.dataShape="PTCSC.Utilization.UtilizationWithDuration" baseType="INFOTABLE" description="" name="result" ordinal="0"/><ParameterDefinitions><FieldDefinition baseType="STRING" description="" name="EquipmentID" ordinal="1"/><FieldDefinition baseType="DATETIME" description="" name="StartDate" ordinal="2"/></ParameterDefinitions></ServiceDefinition><ServiceDefinition aspect.isAsync="false" category="" description="" isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="GetMachineCodeRecord"><ResultType aspect.dataShape="PTCSC.Utilization.MachineCode" baseType="INFOTABLE" description="" name="result" ordinal="0"/><ParameterDefinitions><FieldDefinition baseType="STRING" description="" name="EquipmentID" ordinal="1"/><FieldDefinition baseType="INTEGER" description="" name="MachineCode" ordinal="2"/></ParameterDefinitions></ServiceDefinition><ServiceDefinition aspect.isAsync="false" category="" description="" isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="GetMachineCodesByEquipment"><ResultType aspect.dataShape="PTCSC.Utilization.MachineCode" baseType="INFOTABLE" description="" name="result" ordinal="0"/><ParameterDefinitions><FieldDefinition baseType="STRING" description="" name="EquipmentID" ordinal="1"/></ParameterDefinitions></ServiceDefinition><ServiceDefinition aspect.isAsync="false" category="" description="" isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="GetReasonGroups"><ResultType aspect.dataShape="PTCSC.Utilization.ReasonGroup" baseType="INFOTABLE" description="" name="result" ordinal="0"/><ParameterDefinitions/></ServiceDefinition><ServiceDefinition aspect.isAsync="false" category="" description="" isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="GetReasonGroupsByUtilizationState"><ResultType aspect.dataShape="PTCSC.Utilization.ReasonGroup" baseType="INFOTABLE" description="" name="result" ordinal="0"/><ParameterDefinitions><FieldDefinition baseType="STRING" description="" name="UtilizationState" ordinal="1"/></ParameterDefinitions></ServiceDefinition><ServiceDefinition aspect.isAsync="false" category="" description="" isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="GetReasonsByReasonGroup"><ResultType aspect.dataShape="PTCSC.Utilization.Reason" baseType="INFOTABLE" description="" name="result" ordinal="0"/><ParameterDefinitions><FieldDefinition baseType="STRING" description="" name="ReasonGroup" ordinal="1"/></ParameterDefinitions></ServiceDefinition><ServiceDefinition aspect.isAsync="false" category="" description="" isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="GetReasonsByReasonGroupAndUtilizationState"><ResultType aspect.dataShape="PTCSC.Utilization.Reason" baseType="INFOTABLE" description="" name="result" ordinal="0"/><ParameterDefinitions><FieldDefinition baseType="STRING" description="" name="ReasonGroup" ordinal="1"/><FieldDefinition baseType="STRING" description="" name="UtilizationState" ordinal="2"/></ParameterDefinitions></ServiceDefinition><ServiceDefinition aspect.isAsync="false" category="" description="" isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="GetUtilizationRecordsByMachine"><ResultType baseType="INFOTABLE" description="" name="result" ordinal="0"/><ParameterDefinitions><FieldDefinition baseType="DATETIME" description="" name="EndDate" ordinal="3"/><FieldDefinition baseType="STRING" description="" name="EquipmentID" ordinal="1"/><FieldDefinition baseType="DATETIME" description="" name="StartDate" ordinal="2"/></ParameterDefinitions></ServiceDefinition><ServiceDefinition aspect.isAsync="false" category="" description="" isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="GetUtilizationStateRecord"><ResultType aspect.dataShape="PTCSC.Utilization.UtilizationState" baseType="INFOTABLE" description="" name="result" ordinal="0"/><ParameterDefinitions><FieldDefinition baseType="STRING" description="" name="UtilizationState" ordinal="1"/></ParameterDefinitions></ServiceDefinition><ServiceDefinition aspect.isAsync="false" category="" description="" isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="GetUtilizationStates"><ResultType aspect.dataShape="PTCSC.Utilization.UtilizationState" baseType="INFOTABLE" description="" name="result" ordinal="0"/><ParameterDefinitions/></ServiceDefinition></ServiceDefinitions><EventDefinitions/><ServiceMappings/><ServiceImplementations><ServiceImplementation description="" handlerName="SQLCommand" name="AddOrUpdateMachineCode"><ConfigurationTables><ConfigurationTable dataShapeName="" description="SQLCommand" isMultiRow="false" name="Query" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="NUMBER" description="maxItems" name="maxItems" ordinal="0"/><FieldDefinition baseType="STRING" description="sql" name="sql" ordinal="0"/><FieldDefinition baseType="NUMBER" description="timeout" name="timeout" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><maxItems>500.0</maxItems><sql><![CDATA[EXEC AddOrUpdateMachineCode [[MachineCode]],[[EquipmentID]],[[UtilizationState]],[[ReasonGroup]],[[Reason]]]]></sql><timeout>60.0</timeout></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="SQLCommand" name="AddOrUpdateReason"><ConfigurationTables><ConfigurationTable dataShapeName="" description="SQLCommand" isMultiRow="false" name="Query" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="NUMBER" description="maxItems" name="maxItems" ordinal="0"/><FieldDefinition baseType="STRING" description="sql" name="sql" ordinal="0"/><FieldDefinition baseType="NUMBER" description="timeout" name="timeout" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><maxItems>500.0</maxItems><sql><![CDATA[EXEC AddOrUpdateReason [[Reason]], [[ReasonDescriotion]], [[ReasonGroup]], [[UtilizationState]], [[Failure]]]]></sql><timeout>60.0</timeout></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="SQLCommand" name="AddOrUpdateReasonGroup"><ConfigurationTables><ConfigurationTable dataShapeName="" description="SQLCommand" isMultiRow="false" name="Query" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="NUMBER" description="maxItems" name="maxItems" ordinal="0"/><FieldDefinition baseType="STRING" description="sql" name="sql" ordinal="0"/><FieldDefinition baseType="NUMBER" description="timeout" name="timeout" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><maxItems>500.0</maxItems><sql><![CDATA[EXEC AddOrUpdateReasonGroup [[ReasonGroup]], [[ReasonGroupDescription]], [[ParentReasonGroup]]]]></sql><timeout>60.0</timeout></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="SQLCommand" name="AddOrUpdateUtilizationRecord"><ConfigurationTables><ConfigurationTable dataShapeName="" description="SQLCommand" isMultiRow="false" name="Query" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="NUMBER" description="maxItems" name="maxItems" ordinal="0"/><FieldDefinition baseType="STRING" description="sql" name="sql" ordinal="0"/><FieldDefinition baseType="NUMBER" description="timeout" name="timeout" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><maxItems>500.0</maxItems><sql><![CDATA[EXEC AddOrUpdateUtilizationDataRecord [[Timestamp]],[[EquipmentID]],[[UtilizationState]],[[ReasonGroup]],[[Reason]],[[OperatorID]],[[ShiftID]],[[ProductID]],[[Comment]],[[ModifiedAt]],[[ModifiedBy]]]]></sql><timeout>60.0</timeout></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="SQLCommand" name="AddOrUpdateUtilizationState"><ConfigurationTables><ConfigurationTable dataShapeName="" description="SQLCommand" isMultiRow="false" name="Query" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="NUMBER" description="maxItems" name="maxItems" ordinal="0"/><FieldDefinition baseType="STRING" description="sql" name="sql" ordinal="0"/><FieldDefinition baseType="NUMBER" description="timeout" name="timeout" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><maxItems>500.0</maxItems><sql><![CDATA[EXEC AddOrUpdateUtilizationState [[UtilizationState]], [[UtilizationStateDescription]], [[IncludeInUtilizationCalculation]], [[Utilized]]]]></sql><timeout>60.0</timeout></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="SQLCommand" name="DeleteMachineCode"><ConfigurationTables><ConfigurationTable dataShapeName="" description="SQLCommand" isMultiRow="false" name="Query" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="NUMBER" description="maxItems" name="maxItems" ordinal="0"/><FieldDefinition baseType="STRING" description="sql" name="sql" ordinal="0"/><FieldDefinition baseType="NUMBER" description="timeout" name="timeout" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><maxItems>500.0</maxItems><sql><![CDATA[EXEC DeleteMachineCode [[MachineCode]],[[EquipmentID]]]]></sql><timeout>60.0</timeout></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="SQLCommand" name="DeleteReason"><ConfigurationTables><ConfigurationTable dataShapeName="" description="SQLCommand" isMultiRow="false" name="Query" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="NUMBER" description="maxItems" name="maxItems" ordinal="0"/><FieldDefinition baseType="STRING" description="sql" name="sql" ordinal="0"/><FieldDefinition baseType="NUMBER" description="timeout" name="timeout" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><maxItems>500.0</maxItems><sql><![CDATA[EXEC DeleteReason [[Reason]]]]></sql><timeout>60.0</timeout></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="SQLCommand" name="DeleteReasonGroup"><ConfigurationTables><ConfigurationTable dataShapeName="" description="SQLCommand" isMultiRow="false" name="Query" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="NUMBER" description="maxItems" name="maxItems" ordinal="0"/><FieldDefinition baseType="STRING" description="sql" name="sql" ordinal="0"/><FieldDefinition baseType="NUMBER" description="timeout" name="timeout" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><maxItems>500.0</maxItems><sql><![CDATA[EXEC DeleteReasonGroup [[ReasonGroup]]]]></sql><timeout>60.0</timeout></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="SQLCommand" name="DeleteUtilizationRecords"><ConfigurationTables><ConfigurationTable dataShapeName="" description="SQLCommand" isMultiRow="false" name="Query" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="NUMBER" description="maxItems" name="maxItems" ordinal="0"/><FieldDefinition baseType="STRING" description="sql" name="sql" ordinal="0"/><FieldDefinition baseType="NUMBER" description="timeout" name="timeout" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><maxItems>500.0</maxItems><sql><![CDATA[EXEC DeleteUtilizationData [[DaysBackToRetain]]]]></sql><timeout>60.0</timeout></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="SQLCommand" name="DeleteUtilizationState"><ConfigurationTables><ConfigurationTable dataShapeName="" description="SQLCommand" isMultiRow="false" name="Query" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="NUMBER" description="maxItems" name="maxItems" ordinal="0"/><FieldDefinition baseType="STRING" description="sql" name="sql" ordinal="0"/><FieldDefinition baseType="NUMBER" description="timeout" name="timeout" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><maxItems>500.0</maxItems><sql><![CDATA[EXEC DeleteUtilizationState [[UtilizationState]]]]></sql><timeout>60.0</timeout></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="SQLQuery" name="GetEventDataPriorToMachineTimeStamp"><ConfigurationTables><ConfigurationTable dataShapeName="" description="SQLQuery" isMultiRow="false" name="Query" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="NUMBER" description="maxItems" name="maxItems" ordinal="0"/><FieldDefinition baseType="STRING" description="sql" name="sql" ordinal="0"/><FieldDefinition baseType="NUMBER" description="timeout" name="timeout" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><sql><![CDATA[SELECT TOP(1) TimeStamp as timestamp, EquipmentID, UtilizationState, ReasonGroup, Reason, OperatorID, ShiftID, ProductID, Comment, ModifiedAt, ModifiedBy FROM UtilizationData WHERE EquipmentID = [[EquipmentID]] AND TimeStamp <= [[StartDate]] ORDER BY TimeStamp DESC]]></sql><timeout>60.0</timeout></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="SQLQuery" name="GetMachineCodeRecord"><ConfigurationTables><ConfigurationTable dataShapeName="" description="SQLQuery" isMultiRow="false" name="Query" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="NUMBER" description="maxItems" name="maxItems" ordinal="0"/><FieldDefinition baseType="STRING" description="sql" name="sql" ordinal="0"/><FieldDefinition baseType="NUMBER" description="timeout" name="timeout" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><sql><![CDATA[select * from MachineCode where EquipmentID = [[EquipmentID]] and MachineCode = [[MachineCode]]]]></sql><timeout>60.0</timeout></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="SQLQuery" name="GetMachineCodesByEquipment"><ConfigurationTables><ConfigurationTable dataShapeName="" description="SQLQuery" isMultiRow="false" name="Query" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="NUMBER" description="maxItems" name="maxItems" ordinal="0"/><FieldDefinition baseType="STRING" description="sql" name="sql" ordinal="0"/><FieldDefinition baseType="NUMBER" description="timeout" name="timeout" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><sql><![CDATA[EXEC GetMachineCodesByEquipmentID [[EquipmentID]]]]></sql><timeout>60.0</timeout></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="SQLQuery" name="GetReasonGroups"><ConfigurationTables><ConfigurationTable dataShapeName="" description="SQLQuery" isMultiRow="false" name="Query" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="NUMBER" description="maxItems" name="maxItems" ordinal="0"/><FieldDefinition baseType="STRING" description="sql" name="sql" ordinal="0"/><FieldDefinition baseType="NUMBER" description="timeout" name="timeout" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><sql><![CDATA[SELECT * FROM ReasonGroup ORDER BY ReasonGroup]]></sql><timeout>60.0</timeout></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="SQLQuery" name="GetReasonGroupsByUtilizationState"><ConfigurationTables><ConfigurationTable dataShapeName="" description="SQLQuery" isMultiRow="false" name="Query" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="NUMBER" description="maxItems" name="maxItems" ordinal="0"/><FieldDefinition baseType="STRING" description="sql" name="sql" ordinal="0"/><FieldDefinition baseType="NUMBER" description="timeout" name="timeout" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><sql><![CDATA[EXEC GetReasonGroupsByUtilizationState [[UtilizationState]]]]></sql><timeout>60.0</timeout></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="SQLQuery" name="GetReasonsByReasonGroup"><ConfigurationTables><ConfigurationTable dataShapeName="" description="SQLQuery" isMultiRow="false" name="Query" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="NUMBER" description="maxItems" name="maxItems" ordinal="0"/><FieldDefinition baseType="STRING" description="sql" name="sql" ordinal="0"/><FieldDefinition baseType="NUMBER" description="timeout" name="timeout" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><sql><![CDATA[SELECT * FROM Reason WHERE ReasonGroup = [[ReasonGroup]] ORDER BY Reason]]></sql><timeout>60.0</timeout></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="SQLQuery" name="GetReasonsByReasonGroupAndUtilizationState"><ConfigurationTables><ConfigurationTable dataShapeName="" description="SQLQuery" isMultiRow="false" name="Query" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="NUMBER" description="maxItems" name="maxItems" ordinal="0"/><FieldDefinition baseType="STRING" description="sql" name="sql" ordinal="0"/><FieldDefinition baseType="NUMBER" description="timeout" name="timeout" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><sql><![CDATA[SELECT * FROM Reason WHERE UtilizationState = [[UtilizationState]] AND ReasonGroup = [[ReasonGroup]] ORDER BY Reason]]></sql><timeout>60.0</timeout></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="SQLQuery" name="GetUtilizationRecordsByMachine"><ConfigurationTables><ConfigurationTable dataShapeName="" description="SQLQuery" isMultiRow="false" name="Query" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="NUMBER" description="maxItems" name="maxItems" ordinal="0"/><FieldDefinition baseType="STRING" description="sql" name="sql" ordinal="0"/><FieldDefinition baseType="NUMBER" description="timeout" name="timeout" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><sql><![CDATA[SELECT TimeStamp as timestamp, EquipmentID, UtilizationState, ReasonGroup, Reason, OperatorID, ShiftID, ProductID, Comment, ModifiedAt, ModifiedBy FROM UtilizationData WHERE EquipmentID = [[EquipmentID]] AND TimeStamp <= [[EndDate]] AND TimeStamp >= [[StartDate]] ORDER BY TimeStamp DESC]]></sql><timeout>60.0</timeout></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="SQLQuery" name="GetUtilizationStateRecord"><ConfigurationTables><ConfigurationTable dataShapeName="" description="SQLQuery" isMultiRow="false" name="Query" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="NUMBER" description="maxItems" name="maxItems" ordinal="0"/><FieldDefinition baseType="STRING" description="sql" name="sql" ordinal="0"/><FieldDefinition baseType="NUMBER" description="timeout" name="timeout" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><sql><![CDATA[select * from UtilizationState where UtilizationState = [[UtilizationState]]]]></sql><timeout>60.0</timeout></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="SQLQuery" name="GetUtilizationStates"><ConfigurationTables><ConfigurationTable dataShapeName="" description="SQLQuery" isMultiRow="false" name="Query" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="NUMBER" description="maxItems" name="maxItems" ordinal="0"/><FieldDefinition baseType="STRING" description="sql" name="sql" ordinal="0"/><FieldDefinition baseType="NUMBER" description="timeout" name="timeout" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><sql><![CDATA[SELECT * FROM UtilizationState ORDER BY UtilizationState]]></sql><timeout>60.0</timeout></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation></ServiceImplementations><Subscriptions/></ThingShape><ImplementedShapes/><SharedConfigurationTables/><InstanceDesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></InstanceDesignTimePermissions><InstanceRunTimePermissions><Permissions resourceName="GetUtilizationStates"><PropertyRead/><PropertyWrite/><ServiceInvoke><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_UG" type="Group"/></ServiceInvoke><EventInvoke/><EventSubscribe/></Permissions><Permissions resourceName="GetReasonGroupsByUtilizationState"><PropertyRead/><PropertyWrite/><ServiceInvoke><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_UG" type="Group"/></ServiceInvoke><EventInvoke/><EventSubscribe/></Permissions><Permissions resourceName="GetMachineCodeRecord"><PropertyRead/><PropertyWrite/><ServiceInvoke><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_UG" type="Group"/></ServiceInvoke><EventInvoke/><EventSubscribe/></Permissions><Permissions resourceName="GetReasonGroups"><PropertyRead/><PropertyWrite/><ServiceInvoke><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_UG" type="Group"/></ServiceInvoke><EventInvoke/><EventSubscribe/></Permissions><Permissions resourceName="GetMachineCodesByEquipment"><PropertyRead/><PropertyWrite/><ServiceInvoke><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_UG" type="Group"/></ServiceInvoke><EventInvoke/><EventSubscribe/></Permissions><Permissions resourceName="GetUtilizationStateRecord"><PropertyRead/><PropertyWrite/><ServiceInvoke><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_UG" type="Group"/></ServiceInvoke><EventInvoke/><EventSubscribe/></Permissions><Permissions resourceName="*"><PropertyRead/><PropertyWrite/><ServiceInvoke><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Admin_UG" type="Group"/></ServiceInvoke><EventInvoke/><EventSubscribe/></Permissions><Permissions resourceName="GetReasonsByReasonGroupAndUtilizationState"><PropertyRead/><PropertyWrite/><ServiceInvoke><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_UG" type="Group"/></ServiceInvoke><EventInvoke/><EventSubscribe/></Permissions><Permissions resourceName="GetReasonsByReasonGroup"><PropertyRead/><PropertyWrite/><ServiceInvoke><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_UG" type="Group"/></ServiceInvoke><EventInvoke/><EventSubscribe/></Permissions><Permissions resourceName="GetEventDataPriorToMachineTimeStamp"><PropertyRead/><PropertyWrite/><ServiceInvoke><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_UG" type="Group"/></ServiceInvoke><EventInvoke/><EventSubscribe/></Permissions><Permissions resourceName="GetUtilizationRecordsByMachine"><PropertyRead/><PropertyWrite/><ServiceInvoke><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_UG" type="Group"/></ServiceInvoke><EventInvoke/><EventSubscribe/></Permissions></InstanceRunTimePermissions><InstanceVisibilityPermissions><Visibility/></InstanceVisibilityPermissions><ConfigurationChanges><ConfigurationChange changeAction="CREATE" changeReason="header : name : updated, projectName : updated&#10;" timestamp="2022-11-01T15:11:13.290Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : AddOrUpdateInitialUtilizationStateData : service added&#10;" timestamp="2022-11-01T15:42:30.936Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : AddOrUpdateInitialUtilizationStateData : service updated&#10;" timestamp="2022-11-01T15:47:55.069Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : AddOrUpdateInitialUtilizationStateData : service updated&#10;AddOrUpdateReason : service added&#10;" timestamp="2022-11-02T22:12:24.110Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : AddOrUpdateReasonGroup : service added&#10;" timestamp="2022-11-02T22:14:18.984Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : AddOrUpdateMachineCode : service added&#10;" timestamp="2022-11-02T22:17:17.807Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : AddOrUpdateUtilizationState : service added&#10;" timestamp="2022-11-02T22:20:36.732Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : DeleteMachineCode : service added&#10;" timestamp="2022-11-02T22:22:53.459Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : DeleteReason : service added&#10;" timestamp="2022-11-02T22:23:49.338Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : DeleteReasonGroup : service added&#10;" timestamp="2022-11-02T22:24:51.940Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : DeleteUtilizationState : service added&#10;" timestamp="2022-11-02T22:26:09.926Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : AddOrUpdateInitialUtilizationStateData : service deleted&#10;" timestamp="2022-11-02T22:55:16.282Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : DeleteUtilizationRecords : service added&#10;" timestamp="2022-11-03T14:23:47.013Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : DeleteUtilizationState : service updated&#10;AddOrUpdateUtilizationRecord : service added&#10;" timestamp="2022-11-03T14:27:46.290Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetMachineCodeRecord : service added&#10;" timestamp="2022-11-10T22:02:39.091Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetUtilizationRecordsByMachine : service added&#10;" timestamp="2022-11-10T23:00:47.348Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetUtilizationStateRecord : service added&#10;" timestamp="2022-11-11T19:21:12.177Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetEventDataPriorToMachineTimeStamp : service added&#10;" timestamp="2022-11-12T17:33:41.450Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetUtilizationStates : service added&#10;" timestamp="2022-11-30T02:54:19.669Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetUtilizationStates : service updated&#10;" timestamp="2022-11-30T02:56:21.246Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetReasonsByReasonGroupAndUtilizationState : service added&#10;" timestamp="2022-11-30T02:58:09.251Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetReasonsByReasonGroup : service added&#10;" timestamp="2022-11-30T02:59:14.990Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetReasonGroupsByUtilizationState : service added&#10;" timestamp="2022-11-30T03:00:32.895Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetReasonGroups : service added&#10;" timestamp="2022-11-30T03:02:04.393Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetMachineCodesByEquipment : service added&#10;" timestamp="2022-11-30T03:04:26.213Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetUtilizationStates : service updated&#10;" timestamp="2023-01-19T22:41:44.126Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetUtilizationStates : service updated&#10;" timestamp="2023-01-19T22:50:19.368Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:24.630Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:24.631Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:34.502Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:34.504Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:40.572Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:40.573Z" user="Administrator"/><ConfigurationChange changeAction="CREATE" changeReason="" timestamp="2023-11-01T13:36:32.980Z" user="Administrator"/></ConfigurationChanges></ThingTemplate><ThingTemplate aspect.isSystemObject="false" baseThingTemplate="PTCSC.Utilization.Manager_TT" description="Implementation of PTCSC.Utilization using SQL data objects" documentationContent="" effectiveThingPackage="ConfiguredThing" homeMashup="" inheritedValueStream="" lastModifiedDate="2023-12-07T21:20:21.246Z" name="PTCSC.UtilizationSQLImpl.Manager_TT" projectName="PTCSC.UtilizationSQLImpl" tags="" thingPackage="" valueStream=""><Owner name="Administrator" type="User"/><avatar/><DesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></DesignTimePermissions><RunTimePermissions/><VisibilityPermissions><Visibility><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_OR" type="Organization"/><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_OR:PTCSC.UtilizationSQLImpl.Admin_UG" type="OrganizationalUnit"/></Visibility></VisibilityPermissions><ConfigurationTableDefinitions><ConfigurationTableDefinition category="" dataShapeName="PTCSC.UtilizationSQLImpl.Config_DS" description="General configuration for the Utilization Application" isHidden="false" isMultiRow="false" name="UtilizationConfiguration" ordinal="0" source="IMPORT"/></ConfigurationTableDefinitions><ConfigurationTables><ConfigurationTable dataShapeName="" description="Configuration table used to identify managers that the building block should use" isMultiRow="true" name="ManagerConfiguration" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="true" baseType="STRING" description="unique identifier for the manager that needs to be configured" name="id" ordinal="1"/><FieldDefinition aspect.isPrimaryKey="false" aspect.thingShape="PTC.Base.CommonManagement_TS" baseType="THINGNAME" description="Name of the Manager Thing to be configured" name="managerThingName" ordinal="2"/></FieldDefinitions></DataShape><Rows/></ConfigurationTable><ConfigurationTable dataShapeName="" description="" isMultiRow="true" name="MashupConfiguration" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="true" baseType="STRING" description="unique identifier used to identify the thing or mashup that is being configured" name="id" ordinal="1"/><FieldDefinition aspect.isPrimaryKey="false" baseType="MASHUPNAME" description="name of the mashup to configure" name="mashupName" ordinal="2"/></FieldDefinitions></DataShape><Rows/></ConfigurationTable><ConfigurationTable dataShapeName="" description="Configuration table for dynamic menus. Menu Items can be specified here and they will show up for the given menu name. " isMultiRow="true" name="MenuConfiguration" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="" name="menuItemMashupName" ordinal="2"/><FieldDefinition aspect.isPrimaryKey="true" baseType="STRING" description="" name="menuName" ordinal="3"/><FieldDefinition aspect.isPrimaryKey="false" baseType="INTEGER" description="An optional field to indicate the ordering of the menu items" name="menuOrderPreference" ordinal="5"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="Localization table key for the optional section that groups like menus together" name="menuSectionKey" ordinal="4"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="Localization table key for the menu label" name="menuTitleKey" ordinal="1"/><FieldDefinition aspect.dataShape="PTC.Base.ComponentMenuConfiguration" aspect.isPrimaryKey="false" baseType="INFOTABLE" description="" name="submenu" ordinal="6"/></FieldDefinitions></DataShape><Rows/></ConfigurationTable><ConfigurationTable dataShapeName="" description="Configuration table for any Things that need to be configured. This allows for OOTB things to be customized, and the new version that should be used can be configured here" isMultiRow="true" name="ThingConfiguration" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="true" baseType="STRING" description="unique identifier used to identify the thing or mashup that is being configured" name="id" ordinal="1"/><FieldDefinition aspect.isPrimaryKey="false" baseType="THINGNAME" description="Name of the Thing entity or Mashup entity that is to be configured" name="thingName" ordinal="2"/></FieldDefinitions></DataShape><Rows/></ConfigurationTable><ConfigurationTable dataShapeName="" description="General configuration for the Utilization Application" isMultiRow="false" name="UtilizationConfiguration" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="true" baseType="INTEGER" description="" name="DaysToKeepWhenPurging" ordinal="1"/><FieldDefinition aspect.isPrimaryKey="false" baseType="INTEGER" description="" name="HoursToLookBackOnUtilScreens" ordinal="2"/><FieldDefinition aspect.isPrimaryKey="false" baseType="INTEGER" description="Utilization screen refresh rate (seconds)" name="ScreenRefreshRate" ordinal="3"/><FieldDefinition aspect.isPrimaryKey="false" baseType="INTEGER" description="" name="UtilizationCriticalPercent" ordinal="4"/><FieldDefinition aspect.isPrimaryKey="false" baseType="INTEGER" description="" name="UtilizationWarningPercent" ordinal="5"/></FieldDefinitions></DataShape><Rows><Row><DaysToKeepWhenPurging>0</DaysToKeepWhenPurging><HoursToLookBackOnUtilScreens>0</HoursToLookBackOnUtilScreens><ScreenRefreshRate>0</ScreenRefreshRate><UtilizationCriticalPercent>0</UtilizationCriticalPercent><UtilizationWarningPercent>0</UtilizationWarningPercent></Row></Rows></ConfigurationTable></ConfigurationTables><PropertyBindings/><RemotePropertyBindings/><RemoteServiceBindings/><RemoteEventBindings/><AlertConfigurations/><ThingShape><PropertyDefinitions/><ServiceDefinitions><ServiceDefinition aspect.isAsync="false" category="" description="" isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="GetUtilizationStateRecord"><ResultType aspect.dataShape="PTCSC.Utilization.UtilizationState" baseType="INFOTABLE" description="" name="result" ordinal="0"/><ParameterDefinitions><FieldDefinition baseType="STRING" description="" name="UtilizationState" ordinal="1"/></ParameterDefinitions></ServiceDefinition></ServiceDefinitions><EventDefinitions/><ServiceMappings/><ServiceImplementations><ServiceImplementation description="" handlerName="Script" name="AddDemoMachineCodeDataForEquipment"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[me.AddOrUpdateMachineCode({
	MachineCode: 1000 /* INTEGER */,
	EquipmentID: EquipmentID /* STRING */,
	UtilizationState: "Down" /* STRING */,
	ReasonGroup: "Downtime" /* STRING */,
	Reason: "Unknown" /* STRING */
});

me.AddOrUpdateMachineCode({
	MachineCode: 1001 /* INTEGER */,
	EquipmentID: EquipmentID /* STRING */,
	UtilizationState: "Down" /* STRING */,
	ReasonGroup: "Electrical" /* STRING */,
	Reason: "Electric Fault" /* STRING */
});

me.AddOrUpdateMachineCode({
	MachineCode: 1002 /* INTEGER */,
	EquipmentID: EquipmentID /* STRING */,
	UtilizationState: "Down" /* STRING */,
	ReasonGroup: "Mechanical" /* STRING */,
	Reason: "Conveyor Jam" /* STRING */
});

me.AddOrUpdateMachineCode({
	MachineCode: 1003 /* INTEGER */,
	EquipmentID: EquipmentID /* STRING */,
	UtilizationState: "Down" /* STRING */,
	ReasonGroup: "Mechanical" /* STRING */,
	Reason: "Feed Issues" /* STRING */
});

me.AddOrUpdateMachineCode({
	MachineCode: 1004 /* INTEGER */,
	EquipmentID: EquipmentID /* STRING */,
	UtilizationState: "Down" /* STRING */,
	ReasonGroup: "Mechanical" /* STRING */,
	Reason: "Tool Adjustment" /* STRING */
});

me.AddOrUpdateMachineCode({
	MachineCode: 1005 /* INTEGER */,
	EquipmentID: EquipmentID /* STRING */,
	UtilizationState: "Down" /* STRING */,
	ReasonGroup: "Misc" /* STRING */,
	Reason: "Cleaning" /* STRING */
});

me.AddOrUpdateMachineCode({
	MachineCode: 1006 /* INTEGER */,
	EquipmentID: EquipmentID /* STRING */,
	UtilizationState: "Idle" /* STRING */,
	ReasonGroup: "Idle" /* STRING */,
	Reason: "No Material" /* STRING */
});

me.AddOrUpdateMachineCode({
	MachineCode: 1007 /* INTEGER */,
	EquipmentID: EquipmentID /* STRING */,
	UtilizationState: "Idle" /* STRING */,
	ReasonGroup: "Idle" /* STRING */,
	Reason: "No Operator" /* STRING */
});

me.AddOrUpdateMachineCode({
	MachineCode: 1008 /* INTEGER */,
	EquipmentID: EquipmentID /* STRING */,
	UtilizationState: "Idle" /* STRING */,
	ReasonGroup: "Idle" /* STRING */,
	Reason: "Waiting on QC" /* STRING */
});

me.AddOrUpdateMachineCode({
	MachineCode: 1009 /* INTEGER */,
	EquipmentID: EquipmentID /* STRING */,
	UtilizationState: "Running" /* STRING */,
	ReasonGroup: "Running" /* STRING */,
	Reason: "Good Production" /* STRING */
});

me.AddOrUpdateMachineCode({
	MachineCode: 1010 /* INTEGER */,
	EquipmentID: EquipmentID /* STRING */,
	UtilizationState: "Setup" /* STRING */,
	ReasonGroup: "Setup" /* STRING */,
	Reason: "Die Change" /* STRING */
});

me.AddOrUpdateMachineCode({
	MachineCode: 1011 /* INTEGER */,
	EquipmentID: EquipmentID /* STRING */,
	UtilizationState: "Setup" /* STRING */,
	ReasonGroup: "Setup" /* STRING */,
	Reason: "Order Change" /* STRING */
});

me.AddOrUpdateMachineCode({
	MachineCode: 1012 /* INTEGER */,
	EquipmentID: EquipmentID /* STRING */,
	UtilizationState: "Setup" /* STRING */,
	ReasonGroup: "Setup" /* STRING */,
	Reason: "Part Change" /* STRING */
});

me.AddOrUpdateMachineCode({
	MachineCode: 1013 /* INTEGER */,
	EquipmentID: EquipmentID /* STRING */,
	UtilizationState: "Unavailable" /* STRING */,
	ReasonGroup: "Unavailable" /* STRING */,
	Reason: "Machine Not Online" /* STRING */
});

me.AddOrUpdateMachineCode({
	MachineCode: 1014 /* INTEGER */,
	EquipmentID: EquipmentID /* STRING */,
	UtilizationState: "Unavailable" /* STRING */,
	ReasonGroup: "Unavailable" /* STRING */,
	Reason: "Meetings" /* STRING */
});

me.AddOrUpdateMachineCode({
	MachineCode: 1015 /* INTEGER */,
	EquipmentID: EquipmentID /* STRING */,
	UtilizationState: "Unavailable" /* STRING */,
	ReasonGroup: "Unavailable" /* STRING */,
	Reason: "Scheduled Off" /* STRING */
});]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="AddOrUpdateInitialReasonData"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[me.AddOrUpdateReason({
	ReasonDescription: "Unknown Downtime" /* STRING */,
	UtilizationState: "Down" /* STRING */,
	ReasonGroup: "Downtime" /* STRING */,
	Failure: false /* BOOLEAN */,
	Reason: "Unknown" /* STRING */
});

me.AddOrUpdateReason({
	ReasonDescription: "Electric Fault" /* STRING */,
	UtilizationState: "Down" /* STRING */,
	ReasonGroup: "Electrical" /* STRING */,
	Failure: true /* BOOLEAN */,
	Reason: "Electric Fault" /* STRING */
});

me.AddOrUpdateReason({
	ReasonDescription: "Conveyor Jam" /* STRING */,
	UtilizationState: "Down" /* STRING */,
	ReasonGroup: "Mechanical" /* STRING */,
	Failure: false /* BOOLEAN */,
	Reason: "Conveyor Jam" /* STRING */
});

me.AddOrUpdateReason({
	ReasonDescription: "Feed Issues" /* STRING */,
	UtilizationState: "Down" /* STRING */,
	ReasonGroup: "Mechanical" /* STRING */,
	Failure: false /* BOOLEAN */,
	Reason: "Feed Issues" /* STRING */
});

me.AddOrUpdateReason({
	ReasonDescription: "Tool Adjustment" /* STRING */,
	UtilizationState: "Down" /* STRING */,
	ReasonGroup: "Mechanical" /* STRING */,
	Failure: false /* BOOLEAN */,
	Reason: "Tool Adjustment" /* STRING */
});

me.AddOrUpdateReason({
	ReasonDescription: "Required machine cleaning" /* STRING */,
	UtilizationState: "Down" /* STRING */,
	ReasonGroup: "Misc" /* STRING */,
	Failure: false /* BOOLEAN */,
	Reason: "Cleaning" /* STRING */
});

me.AddOrUpdateReason({
	ReasonDescription: "Waiting on Raw Materials" /* STRING */,
	UtilizationState: "Idle" /* STRING */,
	ReasonGroup: "Idle" /* STRING */,
	Failure: false /* BOOLEAN */,
	Reason: "No Material" /* STRING */
});

me.AddOrUpdateReason({
	ReasonDescription: "Waiting on Machine Labor Resources" /* STRING */,
	UtilizationState: "Idle" /* STRING */,
	ReasonGroup: "Idle" /* STRING */,
	Failure: false /* BOOLEAN */,
	Reason: "No Operator" /* STRING */
});

me.AddOrUpdateReason({
	ReasonDescription: "Waiting on QC" /* STRING */,
	UtilizationState: "Idle" /* STRING */,
	ReasonGroup: "Idle" /* STRING */,
	Failure: false /* BOOLEAN */,
	Reason: "Waiting on QC" /* STRING */
});

me.AddOrUpdateReason({
	ReasonDescription: "Running as Expected" /* STRING */,
	UtilizationState: "Running" /* STRING */,
	ReasonGroup: "Running" /* STRING */,
	Failure: false /* BOOLEAN */,
	Reason: "Good Production" /* STRING */
});

me.AddOrUpdateReason({
	ReasonDescription: "Die change as part of setup" /* STRING */,
	UtilizationState: "Setup" /* STRING */,
	ReasonGroup: "Setup" /* STRING */,
	Failure: false /* BOOLEAN */,
	Reason: "Die Change" /* STRING */
});

me.AddOrUpdateReason({
	ReasonDescription: "Order change as part of setup" /* STRING */,
	UtilizationState: "Setup" /* STRING */,
	ReasonGroup: "Setup" /* STRING */,
	Failure: false /* BOOLEAN */,
	Reason: "Order Change" /* STRING */
});

me.AddOrUpdateReason({
	ReasonDescription: "Part change as part of setup" /* STRING */,
	UtilizationState: "Setup" /* STRING */,
	ReasonGroup: "Setup" /* STRING */,
	Failure: false /* BOOLEAN */,
	Reason: "Part Change" /* STRING */
});

me.AddOrUpdateReason({
	ReasonDescription: "Scheduled Off - Weekend or Holiday" /* STRING */,
	UtilizationState: "Unavailable" /* STRING */,
	ReasonGroup: "Unavailable" /* STRING */,
	Failure: false /* BOOLEAN */,
	Reason: "Scheduled Off" /* STRING */
});

me.AddOrUpdateReason({
	ReasonDescription: "Machine not connected" /* STRING */,
	UtilizationState: "Unavailable" /* STRING */,
	ReasonGroup: "Unavailable" /* STRING */,
	Failure: false /* BOOLEAN */,
	Reason: "Machine Not Online" /* STRING */
});

me.AddOrUpdateReason({
	ReasonDescription: "Required Employee Meetings" /* STRING */,
	UtilizationState: "Unavailable" /* STRING */,
	ReasonGroup: "Unavailable" /* STRING */,
	Failure: false /* BOOLEAN */,
	Reason: "Meetings" /* STRING */
});]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="AddOrUpdateInitialReasonGroupData"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[me.AddOrUpdateReasonGroup({
	ParentReasonGroup: "" /* STRING */,
	ReasonGroupDescription: "General Group for Downtime" /* STRING */,
	ReasonGroup: "Downtime" /* STRING */
});

me.AddOrUpdateReasonGroup({
	ParentReasonGroup: "" /* STRING */,
	ReasonGroupDescription: "General Group for Idle" /* STRING */,
	ReasonGroup: "Idle" /* STRING */
});

me.AddOrUpdateReasonGroup({
	ParentReasonGroup: "" /* STRING */,
	ReasonGroupDescription: "General Group for Running" /* STRING */,
	ReasonGroup: "Running" /* STRING */
});

me.AddOrUpdateReasonGroup({
	ParentReasonGroup: "" /* STRING */,
	ReasonGroupDescription: "General Group for Setup" /* STRING */,
	ReasonGroup: "Setup" /* STRING */
});

me.AddOrUpdateReasonGroup({
	ParentReasonGroup: "" /* STRING */,
	ReasonGroupDescription: "General Group for Unavailable" /* STRING */,
	ReasonGroup: "Unavailable" /* STRING */
});

me.AddOrUpdateReasonGroup({
	ParentReasonGroup: "Downtime" /* STRING */,
	ReasonGroupDescription: "Electrical Downtime Reasons" /* STRING */,
	ReasonGroup: "Electrical" /* STRING */
});

me.AddOrUpdateReasonGroup({
	ParentReasonGroup: "Downtime" /* STRING */,
	ReasonGroupDescription: "Mechanical Downtime Reasons" /* STRING */,
	ReasonGroup: "Mechanical" /* STRING */
});

me.AddOrUpdateReasonGroup({
	ParentReasonGroup: "Downtime" /* STRING */,
	ReasonGroupDescription: "Misc Downtime Reasons" /* STRING */,
	ReasonGroup: "Misc" /* STRING */
});]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="AddOrUpdateInitialUtilizationStateData"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[me.AddOrUpdateUtilizationState({
	UtilizationStateDescription: "Machine scheduled or available, but faulted" /* STRING */,
	Utilized: false /* BOOLEAN */,
	UtilizationState: "Down" /* STRING */,
	IncludeInUtilizationCalculation: true /* BOOLEAN */
});

me.AddOrUpdateUtilizationState({
	UtilizationStateDescription: "Machine scheduled or available, but not running" /* STRING */,
	Utilized: false /* BOOLEAN */,
	UtilizationState: "Idle" /* STRING */,
	IncludeInUtilizationCalculation: true /* BOOLEAN */
});

me.AddOrUpdateUtilizationState({
	UtilizationStateDescription: "Machine running" /* STRING */,
	Utilized: true /* BOOLEAN */,
	UtilizationState: "Running" /* STRING */,
	IncludeInUtilizationCalculation: true /* BOOLEAN */
});

me.AddOrUpdateUtilizationState({
	UtilizationStateDescription: "Machine in changeover" /* STRING */,
	Utilized: false /* BOOLEAN */,
	UtilizationState: "Setup" /* STRING */,
	IncludeInUtilizationCalculation: true /* BOOLEAN */
});

me.AddOrUpdateUtilizationState({
	UtilizationStateDescription: "Machine not scheduled or otherwise unavailable" /* STRING */,
	Utilized: false /* BOOLEAN */,
	UtilizationState: "Unavailable" /* STRING */,
	IncludeInUtilizationCalculation: false /* BOOLEAN */
});]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="AddOrUpdateMachineCode"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[// result: NUMBER
let result = Things["PTCSC.UtilizationSQLImpl.SQLDatabase"].AddOrUpdateMachineCode({
	MachineCode: MachineCode /* INTEGER */,
	EquipmentID: EquipmentID /* STRING */,
	UtilizationState: UtilizationState /* STRING */,
	ReasonGroup: ReasonGroup /* STRING */,
	Reason: Reason /* STRING */
});]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="AddOrUpdateReason"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[// result: NUMBER
let result = Things["PTCSC.UtilizationSQLImpl.SQLDatabase"].AddOrUpdateReason({
	ReasonDescriotion: ReasonDescription /* STRING */,
	UtilizationState: UtilizationState /* STRING */,
	ReasonGroup: ReasonGroup /* STRING */,
	Reason: Reason /* STRING */,
	Failure: Failure /* BOOLEAN */
});]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="AddOrUpdateReasonGroup"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[// result: NUMBER
let result = Things["PTCSC.UtilizationSQLImpl.SQLDatabase"].AddOrUpdateReasonGroup({
	ParentReasonGroup: ParentReasonGroup /* STRING */,
	ReasonGroupDescription: ReasonGroupDescription /* STRING */,
	ReasonGroup: ReasonGroup /* STRING */
});]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="AddOrUpdateUtilizationState"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[// result: NUMBER
let result = Things["PTCSC.UtilizationSQLImpl.SQLDatabase"].AddOrUpdateUtilizationState({
	UtilizationStateDescription: UtilizationStateDescription /* STRING */,
	Utilized: Utilized /* BOOLEAN */,
	UtilizationState: UtilizationState /* STRING */,
	IncludeInUtilizationCalculation: IncludeInUtilizationCalculation /* BOOLEAN */
});]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="AddUtilizationRecord"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
    // result: NUMBER
    let result = Things["PTCSC.UtilizationSQLImpl.SQLDatabase"].AddOrUpdateUtilizationRecord({
        ModifiedAt: undefined /* DATETIME */,
        Comment: undefined /* STRING */,
        EquipmentID: EquipmentID /* STRING */,
        ShiftID: ShiftID /* STRING */,
        UtilizationState: UtilizationState /* STRING */,
        ProductID: ProductID /* STRING */,
        OperatorID: OperatorID /* STRING */,
        ModifiedBy: undefined /* STRING */,
        Timestamp: Timestamp /* DATETIME */,
        ReasonGroup: ReasonGroup /* STRING */,
        Reason: Reason /* STRING */
    });
} catch (err) {
	logger.error(me.name + " Service AddUtilizationRecord error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="DeleteMachineCode"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[// result: NUMBER
let result = Things["PTCSC.UtilizationSQLImpl.SQLDatabase"].DeleteMachineCode({
	MachineCode: MachineCode /* INTEGER */,
	EquipmentID: EquipmentID /* STRING */
});]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="DeleteReason"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[// result: NUMBER
let result = Things["PTCSC.UtilizationSQLImpl.SQLDatabase"].DeleteReason({
	Reason: Reason /* STRING */
});]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="DeleteReasonGroup"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[// result: NUMBER
let result = Things["PTCSC.UtilizationSQLImpl.SQLDatabase"].DeleteReasonGroup({
	ReasonGroup: ReasonGroup /* STRING */
});]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="DeleteUtilizationRecords"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
	// get the configuration table entry for DaysToRetain
    var UtilizationConfiguration = me.GetConfigurationTable({
        tableName: "UtilizationConfiguration" /* STRING */
    });

    var DaysToRetain = UtilizationConfiguration.rows[0].DaysToKeepWhenPurging;    

    let result = Things["PTCSC.UtilizationSQLImpl.SQLDatabase"].DeleteUtilizationRecords({
        DaysBackToRetain: DaysToRetain /* INTEGER */
    });      
} catch (err) {
	logger.error(me.name + " Service DeleteUtilizationRecords error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="DeleteUtilizationState"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[// result: NUMBER
let result = Things["PTCSC.UtilizationSQLImpl.SQLDatabase"].DeleteUtilizationState({
	UtilizationState: UtilizationState /* STRING */
});]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetAggregatesByUtilizationReason"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
    var params = {
        t: UtilizationRecords /* INFOTABLE */,
        columns: "Duration,Duration,Duration,Duration,Duration" /* STRING */,
        aggregates: "MIN,MAX,AVERAGE,SUM,COUNT" /* STRING */,
        groupByColumns: "Reason" /* STRING */
    };

    // result: INFOTABLE
    var AggregateByUtilizationReason = Resources["InfoTableFunctions"].Aggregate(params);

    var params = {
        t: UtilizationRecords /* INFOTABLE */,
        columns: "Duration" /* STRING */,
        aggregates: "SUM" /* STRING */,
        groupByColumns: undefined /* STRING */
    };

    // result: INFOTABLE
    var TotalDuration = Resources["InfoTableFunctions"].Aggregate(params);

    var NumberRows = TotalDuration.rows.length;

    if (NumberRows > 0){
        var row = TotalDuration.rows[0];
        var TotalTimeSec = row.SUM_Duration;
    }

    // Create table for service result
    var params = {
        infoTableName : "InfoTable",
        dataShapeName : "PTCSC.Utilization.ReasonAggregate"
    };

    // CreateInfoTableFromDataShape(infoTableName:STRING("InfoTable"), dataShapeName:STRING):INFOTABLE(PTCSC.Utilization.ReasonAggregate)
    var result = Resources["InfoTableFunctions"].CreateInfoTableFromDataShape(params);

    var tableLength = AggregateByUtilizationReason.rows.length;

    for (var x = 0; x < tableLength; x++) {
        var row = AggregateByUtilizationReason.rows[x];
        var NewRecord = {};
        NewRecord.UtilizationReason = row.Reason;
        NewRecord.SUM_Duration = row.SUM_Duration;
        NewRecord.MIN_Duration = row.MIN_Duration;
        NewRecord.MAX_Duration = row.MAX_Duration;
        NewRecord.AVERAGE_Duration = row.AVERAGE_Duration;
        NewRecord.COUNT_Duration = row.COUNT_Duration;
        if(TotalTimeSec > 0){NewRecord.Percentage = Math.round((row.SUM_Duration / TotalTimeSec)*10000)/100};
        NewRecord.SUM_Duration_Minutes = Math.round((row.SUM_Duration / 60)*100)/100;
        NewRecord.SUM_Duration_Hours = Math.round((row.SUM_Duration / 3600)*100)/100;
        result.AddRow(NewRecord);
    }

    var params = {
        sortColumn: "SUM_Duration" /* STRING */,
        t: result /* INFOTABLE */,
        ascending: false /* BOOLEAN */
    };

    // result: INFOTABLE
    var result = Resources["InfoTableFunctions"].Sort(params); 
} catch (err) {
	logger.error(me.name + " Service GetAggregatesByUtilizationReason error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetAggregatesByUtilizationState"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
    var params = {
        t: UtilizationRecords /* INFOTABLE */,
        columns: "Duration,Duration,Duration,Duration,Duration" /* STRING */,
        aggregates: "MIN,MAX,AVERAGE,SUM,COUNT" /* STRING */,
        groupByColumns: "UtilizationState" /* STRING */
    };

    // result: INFOTABLE
    var AggregateByUtilizationState = Resources["InfoTableFunctions"].Aggregate(params);

    var params = {
        t: UtilizationRecords /* INFOTABLE */,
        columns: "Duration" /* STRING */,
        aggregates: "SUM" /* STRING */,
        groupByColumns: undefined /* STRING */
    };

    // result: INFOTABLE
    var TotalDuration = Resources["InfoTableFunctions"].Aggregate(params);

    var NumberRows = TotalDuration.rows.length;

    if (NumberRows > 0){
        var row = TotalDuration.rows[0];
        var TotalTimeSec = row.SUM_Duration;
    }

    // Create table for service result
    var params = {
        infoTableName : "InfoTable",
        dataShapeName : "PTCSC.Utilization.Aggregate"
    };

    // CreateInfoTableFromDataShape(infoTableName:STRING("InfoTable"), dataShapeName:STRING):INFOTABLE(PTCSC.Utilization.Aggregate)
    var result = Resources["InfoTableFunctions"].CreateInfoTableFromDataShape(params);

    var tableLength = AggregateByUtilizationState.rows.length;

    for (var x = 0; x < tableLength; x++) {
        var row = AggregateByUtilizationState.rows[x];
        var NewRecord = {};
        NewRecord.UtilizationState = row.UtilizationState;
        NewRecord.SUM_Duration = row.SUM_Duration;
        NewRecord.MIN_Duration = row.MIN_Duration;
        NewRecord.MAX_Duration = row.MAX_Duration;
        NewRecord.AVERAGE_Duration = row.AVERAGE_Duration;
        NewRecord.COUNT_Duration = row.COUNT_Duration;
        if(TotalTimeSec > 0){NewRecord.Percentage = Math.round((row.SUM_Duration / TotalTimeSec)*10000)/100};
        NewRecord.SUM_Duration_Minutes = Math.round((row.SUM_Duration / 60)*100)/100;
        NewRecord.SUM_Duration_Hours = Math.round((row.SUM_Duration / 3600)*100)/100;
        result.AddRow(NewRecord);

    }

    var params = {
        sortColumn: "SUM_Duration" /* STRING */,
        t: result /* INFOTABLE */,
        ascending: false /* BOOLEAN */
    };

    // result: INFOTABLE
    var result = Resources["InfoTableFunctions"].Sort(params);   
} catch (err) {
	logger.error(me.name + " Service GetAggregatesByUtilizationState error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetElapsedTime"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
    var date1 = new Date();

    // dateDifference(date1:DATETIME,date2:DATETIME):NUMBER
    var difference = dateDifference(date1, EventStart);

    var params = {
        infoTableName : "InfoTable",
        dataShapeName : "PTCSC.Utilization.ElapsedTime"
    };

    // CreateInfoTableFromDataShape(infoTableName:STRING("InfoTable"), dataShapeName:STRING):INFOTABLE(PTCSC.Utilization.ElapsedTime)
    var result = Resources["InfoTableFunctions"].CreateInfoTableFromDataShape(params);

    var row= {};

    row.Seconds = Math.round((difference/1000)*100)/100;
    row.Minutes = Math.round((difference/60000)*100)/100;
    row.Hours = Math.round((difference/3600000)*100)/100;

    result.AddRow(row);   
} catch (err) {
	logger.error(me.name + " Service GetElapsedTime error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetEventDataPriorToMachineTimeStamp"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[// result: INFOTABLE dataShape: "PTCSC.Utilization.UtilizationWithDuration"
let result = Things["PTCSC.UtilizationSQLImpl.SQLDatabase"].GetEventDataPriorToMachineTimeStamp({
    StartDate: StartDate /* DATETIME */,
    EquipmentID: EquipmentID /* STRING */
});
]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetFilteredUtilizationDataAndStats"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
    // get the utilization records
    if (EquipmentID == "AllUtilizationMachines"){
        // result: INFOTABLE dataShape: "PTCSC.Utilization.UtilizationWithDuration"
        var UtilizationRecords =  me.GetUtilizationRecords({
            StartDate: StartDate /* DATETIME */,
            EndDate: EndDate /* DATETIME */
        });
    }
    else{
        // result: INFOTABLE dataShape: "PTCSC.Utilization.UtilizationWithDuration"
        var UtilizationRecords =  me.GetUtilizationRecordsByMachine({
            StartDate: StartDate /* DATETIME */,
            EndDate: EndDate /* DATETIME */,
            Machine: EquipmentID /* STRING */
        });
    }

    //filter the utilization records by the supplied utilization state
    var FilteredUtilizationRecords =  me.GetFilteredUtilizationRecords({
        UtilizationState: UtilizationState /* STRING */,
        UtilizationRecords: UtilizationRecords /* INFOTABLE */
    });

    // sort filtered records
    var params = {
        sortColumn: "EventStart" /* STRING */,
        t: FilteredUtilizationRecords /* INFOTABLE */,
        ascending: false /* BOOLEAN */
    };

    // result: INFOTABLE
    var FilteredUtilizationRecords = Resources["InfoTableFunctions"].Sort(params);

    // aggregate the filtered records by reason code
    var FilteredUtilizationRecordsAggregatedByReason =  me.GetAggregatesByUtilizationReason({
        UtilizationRecords: FilteredUtilizationRecords /* INFOTABLE */
    });

    // get stats for the filtered records
    var StatsForFilteredRecords =  me.GetUtilizationRecordsSumAvgCount({
        UtilizationRecords: FilteredUtilizationRecords /* INFOTABLE */
    });

    // create an infotable to house the results
    var params = {
        infoTableName : "InfoTable",
        dataShapeName : "PTCSC.Utilization.UtilizationAndStatistics"
    };

    // CreateInfoTableFromDataShape(infoTableName:STRING("InfoTable"), dataShapeName:STRING):INFOTABLE(PTCSC.Utilization.UtilizationAndStatistics)
    var result = Resources["InfoTableFunctions"].CreateInfoTableFromDataShape(params);

    // create the infotable row object
    var ResultRow = {};
    ResultRow.UtilizationRecords = FilteredUtilizationRecords;
    ResultRow.UtilizationStats = StatsForFilteredRecords;
    ResultRow.UtilizationRecordsAggregatedByReason = FilteredUtilizationRecordsAggregatedByReason;

    // insert the row in the result infotable
    result.AddRow(ResultRow);  
} catch (err) {
	logger.error(me.name + " Service GetFilteredUtilizationDataAndStats error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetFilteredUtilizationRecords"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
    var query = {
      "filters": {
        "fieldName": "UtilizationState",
        "type": "EQ",
        "value": UtilizationState
      }
    };

    var params = {
        t: UtilizationRecords /* INFOTABLE */,
        query: query /* QUERY */
    };

    // result: INFOTABLE
    var result = Resources["InfoTableFunctions"].Query(params);

    var params = {
        sortColumn: "EventStart" /* STRING */,
        t: result /* INFOTABLE */,
        ascending: false /* BOOLEAN */
    };

    // result: INFOTABLE
    var result = Resources["InfoTableFunctions"].Sort(params);

    var params = {
        sortColumn: "EquipmentID" /* STRING */,
        t: result /* INFOTABLE */,
        ascending: false /* BOOLEAN */
    };

    // result: INFOTABLE
    var result = Resources["InfoTableFunctions"].Sort(params);   
} catch (err) {
	logger.error(me.name + " Service GetFilteredUtilizationRecords error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetMachineCodeRecord"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[// result: INFOTABLE dataShape: "PTCSC.Utilization.MachineCode"
let result = Things["PTCSC.UtilizationSQLImpl.SQLDatabase"].GetMachineCodeRecord({
	MachineCode: MachineCode /* INTEGER */,
	EquipmentID: EquipmentID /* STRING */
});]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetMachineCodesByEquipment"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
    // result: INFOTABLE dataShape: "PTCSC.Utilization.MachineCode"
    var result = Things["PTCSC.UtilizationSQLImpl.SQLDatabase"].GetMachineCodesByEquipment({
        EquipmentID: EquipmentID /* STRING */
    });
} catch (err) {
	logger.error(me.name + " Service GetMachineCodesByEquipment error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetMachineListingWithDates"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
	// get the configuration table entries
    var UtilizationConfiguration = me.GetConfigurationTable({
        tableName: "UtilizationConfiguration" /* STRING */
    });

    var ConfigCritical = UtilizationConfiguration.rows[0].UtilizationCriticalPercent;
    var ConfigWarning = UtilizationConfiguration.rows[0].UtilizationWarningPercent;
    
    // create infotable for service result
    var params = {
        infoTableName : "InfoTable",
        dataShapeName : "PTCSC.Utilization.MachineStartEndDates"
    };

    // CreateInfoTableFromDataShape(infoTableName:STRING("InfoTable"), dataShapeName:STRING):INFOTABLE(PTCSC.Utilization.MachineStartEndDates)
    var result = Resources["InfoTableFunctions"].CreateInfoTableFromDataShape(params);

    // get machine listing
    var Machines =  ThingShapes["PTCSC.Utilization.ModelLogic_TS"].GetImplementingThings();

    // iterate through machine list to create service result rows
    var tableLength = Machines.rows.length;

    for (var x = 0; x < tableLength; x++) {
        var row = Machines.rows[x];

        var NewEntry = {};

        NewEntry.StartDate = StartDate;
        NewEntry.EndDate = EndDate;
        NewEntry.EquipmentID = row.name;
        NewEntry.EquipmentDesc = row.description;
        NewEntry.Critical = ConfigCritical;
        NewEntry.Warning = ConfigWarning;

        result.AddRow(NewEntry);
    }

    //sort the result set by description
    var params = {
        sortColumn: "EquipmentDesc" /* STRING */,
        t: result /* INFOTABLE */,
        ascending: true /* BOOLEAN */
    };

    // result: INFOTABLE
    var result = Resources["InfoTableFunctions"].Sort(params);   
} catch (err) {
	logger.error(me.name + " Service GetMachineListingWithDates error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetMachineListingWithProperties"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
    // result: INFOTABLE dataShape: "RootEntityList"
    var result =  ThingShapes["PTCSC.Utilization.ModelLogic_TS"].GetImplementingThingsWithData();

    var params = {
        sortColumn: "description" /* STRING */,
        t: result /* INFOTABLE */,
        ascending: true /* BOOLEAN */
    };

    // result: INFOTABLE
    var result = Resources["InfoTableFunctions"].Sort(params);   
} catch (err) {
	logger.error(me.name + " Service GetMachineListingWithProperties error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetMachineUtilization"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
    // Get the utilization records for the specified machine
    // result: INFOTABLE dataShape: "PTCSC.Utilization.UtilizationWithDuration"
    var UtilRecords =  me.GetUtilizationRecordsByMachine({
        StartDate: StartDate /* DATETIME */,
        EndDate: EndDate /* DATETIME */,
        Machine: EquipmentID /* STRING */
    });

    // Reverse sort the retrieved records on EventStart
    var params = {
        sortColumn: "EventStart" /* STRING */,
        t: UtilRecords /* INFOTABLE */,
        ascending: true /* BOOLEAN */
    };
    // result: INFOTABLE
    var UtilRecordsReverseSort = Resources["InfoTableFunctions"].Sort(params);

    // Aggregate the utilization data based on state
    var AggregatedData =  me.GetAggregatesByUtilizationState({
        UtilizationRecords: UtilRecords /* INFOTABLE */
    });

    // get stats for the aggregated data
    var StatsForAggregatedData =  me.GetStatsForAggregateData({
        AggregatedByUtilizationStateData: AggregatedData /* INFOTABLE */
    });

 	//create empty infotable for the schedule data   
    // CreateInfoTableFromDataShape(infoTableName:STRING("InfoTable"), dataShapeName:STRING):INFOTABLE(PTCSC.Utilization.ResourceScheduleData)
    var ScheduleData = Resources["InfoTableFunctions"].CreateInfoTableFromDataShape({
        infoTableName: "InfoTable",
        dataShapeName: "PTCSC.Utilization.ResourceScheduleData"
    });

    //create empty infotable for the data column of the schedule data
    // CreateInfoTableFromDataShape(infoTableName:STRING("InfoTable"), dataShapeName:STRING):INFOTABLE(PTCSC.Utilization.ScheduleData)
    let ScheduleDataData = Resources["InfoTableFunctions"].CreateInfoTableFromDataShape({
        infoTableName: "InfoTable",
        dataShapeName: "PTCSC.Utilization.ScheduleData"
    });

    //iterate through UtilRecordsReverseSort to create data for schedule widget
    var NewRow = {};
    UtilRecordsReverseSort.rows.toArray().forEach(row => {
        NewRow.reason = row.UtilizationState;
        NewRow.start = row.EventStart;
        NewRow.end = dateAddSeconds(row.EventStart, row.Duration);
		if(row.UtilizationState == "Running"){
            NewRow.color = "MediumSeaGreen";}
        else if(row.UtilizationState == "Down"){
            NewRow.color = "Red";}  
        else if(row.UtilizationState == "Idle"){
            NewRow.color = "Yellow";} 
        else if(row.UtilizationState == "Setup"){
            NewRow.color = "LightSkyBlue";} 
        else {
            NewRow.color = "Silver";}       
		NewRow.info = row.Reason;
        ScheduleDataData.AddRow(NewRow);
    });

    var ResourceScheduleDataRow = {};
    ResourceScheduleDataRow.resource = EquipmentID;
    ResourceScheduleDataRow.data = ScheduleDataData;
	ScheduleData.AddRow(ResourceScheduleDataRow);

    // create empty infotable for the result set
    var params = {
        infoTableName : "InfoTable",
        dataShapeName : "PTCSC.Utilization.Machine"
    };

    // CreateInfoTableFromDataShape(infoTableName:STRING("InfoTable"), dataShapeName:STRING):INFOTABLE(PTCSC.Utilization.Machine)
    var result = Resources["InfoTableFunctions"].CreateInfoTableFromDataShape(params);

    // create result row object and add to result table
    var ResultRow = {};
    ResultRow.UtilizationRecords = UtilRecords;
    ResultRow.ReverseSortUtilizationRecords = UtilRecordsReverseSort;
    ResultRow.AggregatedRecords = AggregatedData;
    ResultRow.AggregateStats = StatsForAggregatedData;
    ResultRow.ScheduleData = ScheduleData;
    result.AddRow(ResultRow);   
} catch (err) {
	logger.error(me.name + " Service GetMachineUtilization error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetReasonGroups"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
	// result: INFOTABLE dataShape: "PTCSC.Utilization.ReasonGroup"
    var result = Things["PTCSC.UtilizationSQLImpl.SQLDatabase"].GetReasonGroups();
} catch (err) {
	logger.error(me.name + " Service GetReasonGroups error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetReasonGroupsByUtilizationState"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
    // result: INFOTABLE dataShape: "PTCSC.Utilization.ReasonGroup"
    var result = Things["PTCSC.UtilizationSQLImpl.SQLDatabase"].GetReasonGroupsByUtilizationState({
        UtilizationState: UtilizationState /* STRING */
    });
} catch (err) {
	logger.error(me.name + " Service GetReasonGroupsByUtilizationState error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetReasonRowNumber"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
    var result = 1;

    var tableLength = ReasonRows.rows.length;
    for (var x=0; x < tableLength; x++) {
        var row = ReasonRows.rows[x];
        if (row.Reason == Reason){
            result = x+1;
        }
    }   
} catch (err) {
	logger.error(me.name + " Service GetReasonRowNumber error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetReasonsByReasonGroup"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
    // result: INFOTABLE dataShape: "PTCSC.Utilization.Reason"
    var result = Things["PTCSC.UtilizationSQLImpl.SQLDatabase"].GetReasonsByReasonGroup({
        ReasonGroup: ReasonGroup /* STRING */
    });
} catch (err) {
	logger.error(me.name + " Service GetReasonsByReasonGroup error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetReasonsByReasonGroupAndUtilizationState"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
    // result: INFOTABLE dataShape: "PTCSC.Utilization.Reason"
    var result = Things["PTCSC.UtilizationSQLImpl.SQLDatabase"].GetReasonsByReasonGroupAndUtilizationState({
        UtilizationState: UtilizationState /* STRING */,
        ReasonGroup: ReasonGroup /* STRING */
    });
} catch (err) {
	logger.error(me.name + " Service GetReasonsByReasonGroupAndUtilizationState error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetStartEndDates"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
	// get the configuration table entries
    var UtilizationConfiguration = me.GetConfigurationTable({
        tableName: "UtilizationConfiguration" /* STRING */
    });

    var ConfigHoursBack = UtilizationConfiguration.rows[0].HoursToLookBackOnUtilScreens;
	var ConfigScreenRefreshRate = UtilizationConfiguration.rows[0].ScreenRefreshRate;
    var ConfigCritical = UtilizationConfiguration.rows[0].UtilizationCriticalPercent;
    var ConfigWarning = UtilizationConfiguration.rows[0].UtilizationWarningPercent;
    
    // timestamp:DATETIME
    var EndDate = new Date();

    HoursBack = ConfigHoursBack * -1;

    // dateAddHours(dateValue:DATETIME,amount:NUMBER):STRING
    var StartDate = dateAddHours(EndDate, HoursBack);

    var params = {
        infoTableName : "InfoTable",
        dataShapeName : "PTCSC.Utilization.StartEndDates"
    };

    // CreateInfoTableFromDataShape(infoTableName:STRING("InfoTable"), dataShapeName:STRING):INFOTABLE(PTCSC.Utilization.StartEndDates)
    var result = Resources["InfoTableFunctions"].CreateInfoTableFromDataShape(params);

    var ResultRecord = {};

    ResultRecord.EndDate = EndDate;
    ResultRecord.StartDate = StartDate;
    ResultRecord.ScreenRefreshRate = ConfigScreenRefreshRate;
    ResultRecord.Critical = ConfigCritical;
    ResultRecord.Warning = ConfigWarning;

    result.AddRow(ResultRecord);   
} catch (err) {
	logger.error(me.name + " Service GetStartEndDates error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetStatsForAggregateData"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
    // create table for service result
    var params = {
        infoTableName : "InfoTable",
        dataShapeName : "PTCSC.Utilization.Statistics"
    };

    // CreateInfoTableFromDataShape(infoTableName:STRING("InfoTable"), dataShapeName:STRING):INFOTABLE(PTCSC.Utilization.Statistics)
    var result = Resources["InfoTableFunctions"].CreateInfoTableFromDataShape(params);

    //variables for stats
    var EventCount = 0;
    var TotalTime = 0;
    var Uptime = 0;
    var Downtime = 0;

    // loop through aggregated records passed in
    var tableLength = AggregatedByUtilizationStateData.rows.length;

    for (var x = 0; x < tableLength; x++) {
        var row = AggregatedByUtilizationStateData.rows[x];
        //Look up record from the UtilizationState table

        // result: INFOTABLE dataShape: "PTCSC.Utilization.UtilizationState"
        var UtilizationStateRecord = me.GetUtilizationStateRecord({
            UtilizationState: row.UtilizationState /* STRING */
        });        

        var UtilRow = UtilizationStateRecord.rows[0];

        EventCount = EventCount + row.COUNT_Duration;
        TotalTime = TotalTime + row.SUM_Duration;
        if (UtilRow.IncludeInUtilizationCalculation == true){
            if (UtilRow.Utilized == true){
                Uptime = Uptime + row.SUM_Duration;}
            else {Downtime = Downtime + row.SUM_Duration;}
        }
    }

    var StatRow = {};

    StatRow.EventCount = EventCount;
    StatRow.TotalTimeSec = Math.round(TotalTime*100)/100;
    StatRow.TotalTimeMin = Math.round((TotalTime/60)*100)/100;
    StatRow.TotalTimeHour = Math.round((TotalTime/3600)*100)/100;
    StatRow.UptimeSec = Math.round(Uptime*100)/100;
    StatRow.UptimeMin = Math.round((Uptime/60)*100)/100;
    StatRow.UptimeHour = Math.round((Uptime/3600)*100)/100;
    StatRow.DowntimeSec = Math.round(Downtime*100)/100;
    StatRow.DowntimeMin = Math.round((Downtime/60)*100)/100;
    StatRow.DowntimeHour = Math.round((Downtime/3600)*100)/100;
    var TotalAvailableTime = Math.round((Uptime + Downtime)*100)/100;
    if (TotalAvailableTime > 0){
        StatRow.UtilizationPercent = Math.round((Uptime / TotalAvailableTime)*10000)/100;
        StatRow.DowntimePercent = Math.round((Downtime / TotalAvailableTime)*10000)/100;}
    if (EventCount > 0){
        StatRow.AvgEventTimeSec = Math.round((TotalTime/EventCount)*100)/100;
        StatRow.AvgEventTimeMin = Math.round((TotalTime/(EventCount*60))*100)/100;
        StatRow.AvgEventTimeHour = Math.round((TotalTime/(EventCount*3600))*100)/100;
    }
    result.AddRow(StatRow);   
} catch (err) {
	logger.error(me.name + " Service GetStatsForAggregateData error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetUtilizationOverview"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
    // get all utilization records for the time span
    var AllUtilizationRecords =  me.GetUtilizationRecords({
        StartDate: StartDate /* DATETIME */,
        EndDate: EndDate /* DATETIME */
    });

    // get listing of machine with start and end dates
    var MachineListing =  me.GetMachineListingWithDates({
        StartDate: StartDate /* DATETIME */,
        EndDate: EndDate /* DATETIME */
    });

    // create the infotable to hold utilization data for each machine
    var params = {
        infoTableName : "InfoTable",
        dataShapeName : "PTCSC.Utilization.RepeatedMachineUtilization"
    };

    // CreateInfoTableFromDataShape(infoTableName:STRING("InfoTable"), dataShapeName:STRING):INFOTABLE(PTCSC.Utilization.RepeatedMachineUtilization)
    var SpecificMachineData = Resources["InfoTableFunctions"].CreateInfoTableFromDataShape(params);

    // interate trhough the machines to pouplate the specific machine infotable
    var tableLength = MachineListing.rows.length;

    for (var x = 0; x < tableLength; x++) {
        var row = MachineListing.rows[x];
        var NewRow = {};
        NewRow.StartDate = row.StartDate;
        NewRow.EndDate = row.EndDate;
        NewRow.EquipmentID = row.EquipmentID;

        //query the specific machine utilization records from AllUtilizationRecords
        //create query object
        var query = {
          "filters": {
            "fieldName": "EquipmentID",
            "type": "EQ",
            "value": row.EquipmentID
          }
        };    

        //query tabele
        var params = {
            t: AllUtilizationRecords /* INFOTABLE */,
            query: query /* QUERY */
        };

        // result: INFOTABLE
        var SpecificMachineUtilization = Resources["InfoTableFunctions"].Query(params);

        //sort descending
        var params = {
            sortColumn: "EventStart" /* STRING */,
            t: SpecificMachineUtilization /* INFOTABLE */,
            ascending: false /* BOOLEAN */
        };

        // result: INFOTABLE
        var SpecificMachineUtilizationDesc = Resources["InfoTableFunctions"].Sort(params);

        NewRow.UtilizationRecords = SpecificMachineUtilizationDesc;

        //sort ascending
        var params = {
            sortColumn: "EventStart" /* STRING */,
            t: SpecificMachineUtilization /* INFOTABLE */,
            ascending: true /* BOOLEAN */
        };

        // result: INFOTABLE
        var SpecificMachineUtilizationAsc = Resources["InfoTableFunctions"].Sort(params);

        NewRow.ReverseSortUtilizationRecords = SpecificMachineUtilizationAsc;    

        // Aggregate the records by state
        var SpecificMachineAggregatedRecords =  me.GetAggregatesByUtilizationState({
            UtilizationRecords: SpecificMachineUtilization /* INFOTABLE */
        });    

        NewRow.AggregatedRecords = SpecificMachineAggregatedRecords;

        // get the stats for the aggregated records
        var AggregateStats =  me.GetStatsForAggregateData({
            AggregatedByUtilizationStateData: SpecificMachineAggregatedRecords /* INFOTABLE */
        });    

        NewRow.AggregateStats = AggregateStats;

        SpecificMachineData.AddRow(NewRow);
    }

    // create infotable to house the service result
    var params = {
        infoTableName : "InfoTable",
        dataShapeName : "PTCSC.Utilization.Overview"
    };

    // CreateInfoTableFromDataShape(infoTableName:STRING("InfoTable"), dataShapeName:STRING):INFOTABLE(PTCSC.Utilization.Overview)
    var result = Resources["InfoTableFunctions"].CreateInfoTableFromDataShape(params);

    var ResultRow = {};

    // aggregate all of the machine data
    var AllMachineDataAggregatedByState =  me.GetAggregatesByUtilizationState({
        UtilizationRecords: AllUtilizationRecords /* INFOTABLE */
    });

    ResultRow.AllUtilizationDataAggregatedByState = AllMachineDataAggregatedByState;
    ResultRow.UtilizationDataByMachine = SpecificMachineData;
    ResultRow.AllUtilizationData = AllUtilizationRecords;
    result.AddRow(ResultRow);   
} catch (err) {
	logger.error(me.name + " Service GetUtilizationOverview error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetUtilizationOverviewForMachine"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
    //create infotable to house the results of the service
    var params = {
        infoTableName : "InfoTable",
        dataShapeName : "PTCSC.Utilization.Machine"
    };

    // CreateInfoTableFromDataShape(infoTableName:STRING("InfoTable"), dataShapeName:STRING):INFOTABLE(PTCSC.Utilization.Machine)
    var result = Resources["InfoTableFunctions"].CreateInfoTableFromDataShape(params);

    // query utilization records
    var SpecificMachineUtilization =  me.GetUtilizationRecordsByMachine({
        StartDate: StartDate /* DATETIME */,
        EndDate: EndDate /* DATETIME */,
        Machine: EquipmentID /* STRING */
    });

    //sort descending
    var params = {
        sortColumn: "EventStart" /* STRING */,
        t: SpecificMachineUtilization /* INFOTABLE */,
        ascending: false /* BOOLEAN */
    };

    // result: INFOTABLE
    var SpecificMachineUtilizationDesc = Resources["InfoTableFunctions"].Sort(params);

    //set infotable 
    result.UtilizationRecords = SpecificMachineUtilizationDesc;

    //sort ascending
    var params = {
        sortColumn: "EventStart" /* STRING */,
        t: SpecificMachineUtilization /* INFOTABLE */,
        ascending: true /* BOOLEAN */
    };

    // result: INFOTABLE
    var SpecificMachineUtilizationAsc = Resources["InfoTableFunctions"].Sort(params);

    result.ReverseSortUtilizationRecords = SpecificMachineUtilizationAsc;    

    // Aggregate the records by state
    var SpecificMachineAggregatedRecords =  me.GetAggregatesByUtilizationState({
        UtilizationRecords: SpecificMachineUtilization /* INFOTABLE */
    });    

    result.AggregatedRecords = SpecificMachineAggregatedRecords;

    // get the stats for the aggregated records
    var AggregateStats =  me.GetStatsForAggregateData({
        AggregatedByUtilizationStateData: SpecificMachineAggregatedRecords /* INFOTABLE */
    });    

    result.AggregateStats = AggregateStats;   
} catch (err) {
	logger.error(me.name + " Service GetUtilizationOverviewForMachine error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetUtilizationRecords"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
    // create infotable for result
    var params = {
        infoTableName : "InfoTable",
        dataShapeName : "PTCSC.Utilization.UtilizationWithDuration"
    };

    // CreateInfoTableFromDataShape(infoTableName:STRING("InfoTable"), dataShapeName:STRING):INFOTABLE(PTCSC.Utilization.UtilizationWithDuration)
    var result = Resources["InfoTableFunctions"].CreateInfoTableFromDataShape(params);

    // result: INFOTABLE dataShape: RootEntityList
    var MachineListing =  ThingShapes["PTCSC.Utilization.ModelLogic_TS"].GetImplementingThings();

    var tableLength = MachineListing.rows.length;

    for (var x = 0; x < tableLength; x++) {
        var row = MachineListing.rows[x];
        //get utilization records for a machine

        var params = {
            StartDate: StartDate /* DATETIME */,
            EndDate: EndDate /* DATETIME */,
            Machine: row.name /* STRING */
        };

        // result: INFOTABLE dataShape: "UtilizationShapeWithDuration"
        var MachineUtilizationRecords = me.GetUtilizationRecordsByMachine(params);

        //add records to result
        var tableLength2 = MachineUtilizationRecords.rows.length;

        for (var y = 0; y < tableLength2; y++) {
            var innerrow = MachineUtilizationRecords.rows[y];    
            result.AddRow(innerrow);
        }
    }   
} catch (err) {
	logger.error(me.name + " Service GetUtilizationRecords error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetUtilizationRecordsByMachine"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
    
     // result: INFOTABLE dataShape: ""
    let RawUtilizationRecords = Things["PTCSC.UtilizationSQLImpl.SQLDatabase"].GetUtilizationRecordsByMachine({
        StartDate: StartDate /* DATETIME */,
        EquipmentID: Machine /* STRING */,
        EndDate: EndDate /* DATETIME */
    });   
    
    // create an infotable to house the service result
    var params = {
        infoTableName : "InfoTable",
        dataShapeName : "PTCSC.Utilization.UtilizationWithDuration"
    };

    // CreateInfoTableFromDataShape(infoTableName:STRING("InfoTable"), dataShapeName:STRING):INFOTABLE(PTCSC.Utilization.UtilizationWithDuration)
    var result = Resources["InfoTableFunctions"].CreateInfoTableFromDataShape(params);

    // set event end time for latest event to EndDate parameter

    // current time
    var currentTime = new Date();

    // use end time if less than current time, otherwise use current time

    if (EndDate < currentTime){
        var EventEndTime = EndDate;}
    else {var EventEndTime = currentTime;}

    var TimeDifferenceSeconds = 0;

    // create row object to house new record for service result
    var EventRecord = {};

    // loop through raw utilization records, calculate duration and add to service result 
    var tableLength = RawUtilizationRecords.rows.length;

    for (var x = 0; x < tableLength; x++) {
        var row = RawUtilizationRecords.rows[x];
        // Calculate and set event duration
        TimeDifferenceSeconds = dateDifference(EventEndTime, row.timestamp)/1000;
        EventRecord.Duration = Math.round(TimeDifferenceSeconds*100)/100;
        // Set event end time for next record
        EventEndTime = row.timestamp;
        // set the rest of the columns
        EventRecord.EventStart = row.timestamp;
        EventRecord.EquipmentID = row.EquipmentID;
        EventRecord.EquipmentDesc = Things[row.EquipmentID].description;
        EventRecord.UtilizationState = row.UtilizationState;
        EventRecord.ReasonGroup = row.ReasonGroup;
        EventRecord.Reason = row.Reason;
        EventRecord.OperatorID = row.OperatorID;
        EventRecord.ProductID = row.ProductID;
        EventRecord.ShiftID = row.ShiftID;
        EventRecord.Comment = row.Comment;
        EventRecord.ModifiedAt = row.ModifiedAt;
        EventRecord.ModifiedBy = row.ModifiedBy;
        EventRecord.id = row.id;
        // add the record to the service result
        result.AddRow(EventRecord);
    }

    // get the first record
    var params = {
        StartDate: StartDate /* DATETIME */,
        EquipmentID: Machine /* STRING */
    };

    // result: INFOTABLE dataShape: "UtilizationShapeWithDuration"
    var FirstRecord = me.GetEventDataPriorToMachineTimeStamp(params);

    // Calculate and set event duration
    if (FirstRecord.rows.length > 0){
        var row = FirstRecord.rows[0];

        TimeDifferenceSeconds = dateDifference(EventEndTime, StartDate)/1000;
        EventRecord.Duration = Math.round(TimeDifferenceSeconds*100)/100;

        // set the rest of the columns
        EventRecord.EventStart = StartDate;
        EventRecord.EquipmentID = row.EquipmentID;
        EventRecord.EquipmentDesc = Things[row.EquipmentID].description;
        EventRecord.UtilizationState = row.UtilizationState;
        EventRecord.ReasonGroup = row.ReasonGroup;
        EventRecord.Reason = row.Reason;
        EventRecord.OperatorID = row.OperatorID;
        EventRecord.ProductID = row.ProductID;
        EventRecord.ShiftID = row.ShiftID;
        EventRecord.Comment = row.Comment;
        EventRecord.ModifiedAt = row.ModifiedAt;
        EventRecord.ModifiedBy = row.ModifiedBy;
        EventRecord.id = row.id;
        // add the record to the service result
        result.AddRow(EventRecord);}
    else{
        TimeDifferenceSeconds = dateDifference(EventEndTime, StartDate)/1000;
        EventRecord.Duration = Math.round(TimeDifferenceSeconds*100)/100;
        EventRecord.EventStart = StartDate;
        EventRecord.EquipmentID = Machine;
        EventRecord.EquipmentDesc = Things[Machine].description;
        EventRecord.UtilizationState = "Unavailable";
        EventRecord.ReasonGroup = "Unavailable";
        EventRecord.Reason = "Machine Not Online";
        EventRecord.OperatorID = undefined;
        EventRecord.ProductID = undefined;
        EventRecord.ShiftID = undefined;
        EventRecord.Shift = undefined;
        EventRecord.Comment = undefined;
        EventRecord.ModifiedAt = undefined;
        EventRecord.ModifiedBy = undefined;
        EventRecord.id = undefined;   
        // add the record to the service result
        result.AddRow(EventRecord);
    }   
} catch (err) {
	logger.error(me.name + " Service GetUtilizationRecordsByMachine error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetUtilizationRecordsSumAvgCount"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
    // create table for service result
    var params = {
        infoTableName : "InfoTable",
        dataShapeName : "PTCSC.Utilization.Statistics"
    };

    // CreateInfoTableFromDataShape(infoTableName:STRING("InfoTable"), dataShapeName:STRING):INFOTABLE(PTCSC.Utilization.Statistics)
    var result = Resources["InfoTableFunctions"].CreateInfoTableFromDataShape(params);

    var params = {
        t: UtilizationRecords /* INFOTABLE */,
        columns: "Duration,Duration,Duration" /* STRING */,
        aggregates: "SUM,AVERAGE,COUNT" /* STRING */,
        groupByColumns: undefined /* STRING */
    };

    // result: INFOTABLE
    var Aggregate = Resources["InfoTableFunctions"].Aggregate(params);

    var StatRow = {};

    StatRow.EventCount = Aggregate.rows[0].COUNT_Duration;
    StatRow.TotalTimeSec = Math.round(Aggregate.rows[0].SUM_Duration*100)/100;
    StatRow.TotalTimeMin = Math.round((Aggregate.rows[0].SUM_Duration/60)*100)/100;
    StatRow.TotalTimeHour = Math.round((Aggregate.rows[0].SUM_Duration/3600)*100)/100;

    if (StatRow.EventCount > 0){
        StatRow.AvgEventTimeSec = Math.round((StatRow.TotalTimeSec/StatRow.EventCount)*100)/100;
        StatRow.AvgEventTimeMin = Math.round((StatRow.TotalTimeSec/(StatRow.EventCount*60))*100)/100;
        StatRow.AvgEventTimeHour = Math.round((StatRow.TotalTimeSec/(StatRow.EventCount*3600))*100)/100;
    }
    result.AddRow(StatRow);   
} catch (err) {
	logger.error(me.name + " Service GetUtilizationRecordsSumAvgCount error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetUtilizationScheduleData"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
    // Get the utilization records for the specified machine
    // result: INFOTABLE dataShape: "PTCSC.Utilization.UtilizationWithDuration"
    var UtilRecords =  me.GetUtilizationRecordsByMachine({
        StartDate: StartDate /* DATETIME */,
        EndDate: EndDate /* DATETIME */,
        Machine: EquipmentID /* STRING */
    });

    // Reverse sort the retrieved records on EventStart
    var params = {
        sortColumn: "EventStart" /* STRING */,
        t: UtilRecords /* INFOTABLE */,
        ascending: true /* BOOLEAN */
    };
    // result: INFOTABLE
    var UtilRecordsReverseSort = Resources["InfoTableFunctions"].Sort(params);

    // Aggregate the utilization data based on state
    var AggregatedData =  me.GetAggregatesByUtilizationState({
        UtilizationRecords: UtilRecords /* INFOTABLE */
    });

    // get stats for the aggregated data
    var StatsForAggregatedData =  me.GetStatsForAggregateData({
        AggregatedByUtilizationStateData: AggregatedData /* INFOTABLE */
    });

 	//create empty infotable for the schedule data   
    // CreateInfoTableFromDataShape(infoTableName:STRING("InfoTable"), dataShapeName:STRING):INFOTABLE(PTCSC.Utilization.ResourceScheduleData)
    var ScheduleData = Resources["InfoTableFunctions"].CreateInfoTableFromDataShape({
        infoTableName: "InfoTable",
        dataShapeName: "PTCSC.Utilization.ResourceScheduleData"
    });

    //create empty infotable for the data column of the schedule data
    // CreateInfoTableFromDataShape(infoTableName:STRING("InfoTable"), dataShapeName:STRING):INFOTABLE(PTCSC.Utilization.ScheduleData)
    let ScheduleDataData = Resources["InfoTableFunctions"].CreateInfoTableFromDataShape({
        infoTableName: "InfoTable",
        dataShapeName: "PTCSC.Utilization.ScheduleData"
    });

    //iterate through UtilRecordsReverseSort to create data for schedule widget
    var NewRow = {};
    UtilRecordsReverseSort.rows.toArray().forEach(row => {
        NewRow.reason = row.UtilizationState;
        NewRow.start = row.EventStart;
        NewRow.end = dateAddSeconds(row.EventStart, row.Duration);
		if(row.UtilizationState == "Running"){
            NewRow.color = "MediumSeaGreen";}
        else if(row.UtilizationState == "Down"){
            NewRow.color = "Red";}  
        else if(row.UtilizationState == "Idle"){
            NewRow.color = "Yellow";} 
        else if(row.UtilizationState == "Setup"){
            NewRow.color = "LightSkyBlue";} 
        else {
            NewRow.color = "Silver";}      
		NewRow.info = row.Reason;
        NewRow.EquipmentID = row.EquipmentID;
        NewRow.UtilizationState = row.UtilizationState;
        NewRow.ReasonGroup = row.ReasonGroup;
        NewRow.Reason = row.Reason;
        NewRow.OperatorID = row.OperatorID;
        NewRow.ShiftID = row.ShiftID;
        NewRow.Comment = row.Comment;
        NewRow.ModifiedAt = row.ModifiedAt;
        NewRow.ModifiedBy = row.ModifiedBy;
        NewRow.Duration = row.Duration;
        NewRow.EventStart = row.EventStart;
        NewRow.id = row.id;
        NewRow.ProductID = row.ProductID;
        NewRow.EquipmentDesc = row.EquipmentDesc;       
        ScheduleDataData.AddRow(NewRow);
    });

    var ResourceScheduleDataRow = {};
    ResourceScheduleDataRow.resource = EquipmentID;
    ResourceScheduleDataRow.data = ScheduleDataData;
	ScheduleData.AddRow(ResourceScheduleDataRow);
    
    // create empty infotable for the result set
    var params = {
        infoTableName : "InfoTable",
        dataShapeName : "PTCSC.Utilization.UtilizationSchedule"
    };

    // CreateInfoTableFromDataShape(infoTableName:STRING("InfoTable"), dataShapeName:STRING):INFOTABLE(PTCSC.Utilization.UtilizationSchedule)
    var result = Resources["InfoTableFunctions"].CreateInfoTableFromDataShape(params);

    // create result row object and add to result table
    var ResultRow = {};
    ResultRow.UtilizationRecords = ScheduleData;
    ResultRow.UtilizationPercent = StatsForAggregatedData.rows[0].UtilizationPercent;
    result.AddRow(ResultRow);   
} catch (err) {
	logger.error(me.name + " Service GetUtilizationScheduleData error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetUtilizationStateRecord"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[// result: INFOTABLE dataShape: "PTCSC.Utilization.UtilizationState"
var result = Things["PTCSC.UtilizationSQLImpl.SQLDatabase"].GetUtilizationStateRecord({
	UtilizationState: UtilizationState /* STRING */
});]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="GetUtilizationStates"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
    // result: INFOTABLE dataShape: "PTCSC.Utilization.UtilizationState"
    var result = Things["PTCSC.UtilizationSQLImpl.SQLDatabase"].GetUtilizationStates();
} catch (err) {
	logger.error(me.name + " Service GetUtilizationStates error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="UpdateUtilizationEventRecord"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
    // timestamp:DATETIME
    var dateValue = new Date();

    // result: NUMBER
    let result = Things["PTCSC.UtilizationSQLImpl.SQLDatabase"].AddOrUpdateUtilizationRecord({
        ModifiedAt: dateValue /* DATETIME */,
        Comment: Comment /* STRING */,
        EquipmentID: EquipmentID /* STRING */,
        ShiftID: ShiftID /* STRING */,
        UtilizationState: UtilizationState /* STRING */,
        ProductID: ProductID /* STRING */,
        OperatorID: OperatorID /* STRING */,
        ModifiedBy: ModifiedBy /* STRING */,
        Timestamp: EventStart /* DATETIME */,
        ReasonGroup: ReasonGroup /* STRING */,
        Reason: Reason /* STRING */
    });   
} catch (err) {
	logger.error(me.name + " Service UpdateUtilizationEventRecord error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="UtilizationAggregatesPassThrough"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[var result = UtilizationAggregates;]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="UtilizationRecordsPassThrough"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[try {
	var result = UtilizationRecords;
} catch (err) {
	logger.error(me.name + " Service SERVICENAMEHERE error at line " + err.lineNumber + ": " + err);  
}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="UtilizationScheduleDataPassThrough"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[var result = ScheduleData;]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="UtilizationStatisticsPassThrough"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[var result = UtilizationAggregateStats;]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation></ServiceImplementations><Subscriptions><Subscription description="" enabled="true" eventName="Timer" name="UtilizationDataPurge" source="PTCSC.Utilization.RecordPurge_TM" sourceProperty="" sourceType="Thing"><ServiceImplementation description="" handlerName="Script" name="UtilizationDataPurge"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[me.DeleteUtilizationRecords({
	DaysBackToRetain: undefined /* INTEGER */
});]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation></Subscription></Subscriptions></ThingShape><ImplementedShapes><ImplementedShape name="PTCSC.UtilizationSQLImpl.Management_TS" type="ThingShape"/></ImplementedShapes><SharedConfigurationTables/><InstanceDesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></InstanceDesignTimePermissions><InstanceRunTimePermissions><Permissions resourceName="GetUtilizationStateRecord"><PropertyRead/><PropertyWrite/><ServiceInvoke><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_UG" type="Group"/></ServiceInvoke><EventInvoke/><EventSubscribe/></Permissions><Permissions resourceName="*"><PropertyRead/><PropertyWrite/><ServiceInvoke><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Admin_UG" type="Group"/></ServiceInvoke><EventInvoke/><EventSubscribe/></Permissions></InstanceRunTimePermissions><InstanceVisibilityPermissions><Visibility/></InstanceVisibilityPermissions><ConfigurationChanges><ConfigurationChange changeAction="CREATE" changeReason="Created Programmatically" timestamp="2022-11-01T15:09:34.531Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="Adding ThingShape PTCSC.UtilizationSQLImpl.Management_TS to thing tempalte PTCSC.UtilizationSQLImpl.Manager_TT" timestamp="2022-11-01T15:09:34.567Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="SetProjectName : [PTCSC.UtilizationSQLImpl]" timestamp="2022-11-01T15:09:34.604Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : AddOrUpdateInitialUtilizationStateData : service added&#10;" timestamp="2022-11-01T15:44:48.730Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : AddOrUpdateMachineCode : service added&#10;" timestamp="2022-11-02T22:33:10.446Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : AddOrUpdateReason : service added&#10;" timestamp="2022-11-02T22:34:32.313Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : AddOrUpdateReasonGroup : service added&#10;" timestamp="2022-11-02T22:36:38.509Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : AddOrUpdateUtilizationState : service added&#10;" timestamp="2022-11-02T22:38:11.825Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : DeleteReason : service added&#10;" timestamp="2022-11-02T22:38:51.764Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : DeleteReasonGroup : service added&#10;" timestamp="2022-11-02T22:40:13.430Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : DeleteMachineCode : service added&#10;" timestamp="2022-11-02T22:40:49.531Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : DeleteUtilizationState : service added&#10;" timestamp="2022-11-02T22:41:20.160Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : AddOrUpdateInitialUtilizationStateData : service updated&#10;" timestamp="2022-11-02T23:00:42.479Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : AddOrUpdateInitialReasonGroupData : service added&#10;" timestamp="2022-11-02T23:09:47.045Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : AddOrUpdateInitialReasonData : service added&#10;" timestamp="2022-11-02T23:23:45.559Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : AddDemoMachineCodeDataForEquipment : service added&#10;" timestamp="2022-11-02T23:27:06.761Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : AddUtilizationRecord : service added&#10;" timestamp="2022-11-03T14:33:55.827Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : UpdateUtilizationEventRecord : service added&#10;" timestamp="2022-11-03T14:37:10.956Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : DeleteUtilizationRecords : service added&#10;" timestamp="2022-11-03T14:39:00.438Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetMachineCodeRecord : service added&#10;" timestamp="2022-11-10T22:04:14.798Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetElapsedTime : service added&#10;" timestamp="2022-11-10T22:12:53.849Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : UtilizationRecordsPassThrough : service added&#10;" timestamp="2022-11-10T22:23:42.018Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetAggregatesByUtilizationState : service added&#10;" timestamp="2022-11-10T22:55:02.009Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetStatsForAggregateData : service added&#10;" timestamp="2022-11-10T22:56:07.600Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetUtilizationRecordsByMachine : service added&#10;" timestamp="2022-11-10T23:05:46.217Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetMachineUtilization : service added&#10;" timestamp="2022-11-10T23:09:18.022Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetStatsForAggregateData : service updated&#10;GetUtilizationStateRecord : service added&#10;" timestamp="2022-11-11T19:25:52.225Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetStatsForAggregateData : service updated&#10;" timestamp="2022-11-11T19:28:04.506Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="subscriptions : UtilizationDataPurge : added&#10;" timestamp="2022-11-11T20:28:59.555Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetEventDataPriorToMachineTimeStamp : service added&#10;" timestamp="2022-11-12T17:36:20.539Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetEventDataPriorToMachineTimeStamp : service updated&#10;" timestamp="2022-11-12T18:03:37.404Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetMachineCodesByEquipment : service added&#10;" timestamp="2022-11-30T03:14:19.866Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetReasonGroups : service added&#10;" timestamp="2022-11-30T03:15:35.950Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetReasonGroups : service updated&#10;" timestamp="2022-11-30T03:16:43.221Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetMachineCodesByEquipment : service updated&#10;" timestamp="2022-11-30T03:17:38.913Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetReasonGroupsByUtilizationState : service added&#10;" timestamp="2022-11-30T03:19:01.228Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetReasonsByReasonGroup : service added&#10;" timestamp="2022-11-30T03:20:13.895Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetReasonsByReasonGroupAndUtilizationState : service added&#10;" timestamp="2022-11-30T03:21:32.834Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetUtilizationStates : service added&#10;" timestamp="2022-11-30T03:22:36.043Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetUtilizationStates : service updated&#10;" timestamp="2022-11-30T03:29:17.198Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetReasonGroups : service updated&#10;" timestamp="2022-11-30T03:30:28.388Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetMachineCodesByEquipment : service updated&#10;" timestamp="2022-11-30T03:31:20.617Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetReasonGroupsByUtilizationState : service updated&#10;" timestamp="2022-11-30T03:31:37.551Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetReasonsByReasonGroup : service updated&#10;" timestamp="2022-11-30T03:31:52.030Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetReasonsByReasonGroupAndUtilizationState : service updated&#10;" timestamp="2022-11-30T03:32:05.197Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetUtilizationRecords : service added&#10;" timestamp="2022-11-30T21:50:26.152Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetUtilizationRecordsSumAvgCount : service added&#10;" timestamp="2022-11-30T21:59:37.779Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetMachineListingWithDates : service added&#10;" timestamp="2022-11-30T22:06:20.775Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetMachineListingWithProperties : service added&#10;" timestamp="2022-11-30T22:08:08.626Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetReasonRowNumber : service added&#10;" timestamp="2022-11-30T22:09:28.794Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetStartEndDates : service added&#10;" timestamp="2022-11-30T22:11:05.244Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetFilteredUtilizationRecords : service added&#10;" timestamp="2022-11-30T22:13:22.719Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetFilteredUtilizationDataAndStats : service added&#10;" timestamp="2022-11-30T22:15:25.426Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetUtilizationOverview : service added&#10;" timestamp="2022-11-30T22:17:26.212Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetUtilizationOverviewForMachine : service added&#10;" timestamp="2022-11-30T22:18:53.768Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetAggregatesByUtilizationReason : service added&#10;" timestamp="2022-12-01T01:19:15.373Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetStatsForAggregateData : service updated&#10;" timestamp="2022-12-01T01:30:00.990Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetUtilizationStateRecord : service updated&#10;" timestamp="2022-12-01T01:34:23.274Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetAggregatesByUtilizationState : service updated&#10;" timestamp="2022-12-01T01:57:29.694Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetAggregatesByUtilizationState : service updated&#10;" timestamp="2022-12-02T16:03:29.563Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetMachineUtilization : service updated&#10;" timestamp="2022-12-13T22:32:25.360Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetMachineUtilization : service updated&#10;" timestamp="2022-12-13T22:47:03.568Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetUtilizationScheduleData : service added&#10;" timestamp="2022-12-16T14:12:02.527Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetUtilizationScheduleData : service updated&#10;" timestamp="2022-12-16T14:31:56.011Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetUtilizationScheduleData : service updated&#10;" timestamp="2022-12-21T21:06:15.405Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : UtilizationScheduleDataPassThrough : service added&#10;" timestamp="2022-12-21T21:15:29.113Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : UtilizationStatisticsPassThrough : service added&#10;" timestamp="2023-01-26T00:46:48.236Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : UtilizationAggregatesPassThrough : service added&#10;" timestamp="2023-01-26T14:49:58.109Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:24.621Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:24.624Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:34.493Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:34.495Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:40.563Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:40.565Z" user="Administrator"/><ConfigurationChange changeAction="CREATE" changeReason="" timestamp="2023-11-01T13:36:32.945Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="header : description : updated&#10;" timestamp="2023-11-02T12:50:03.494Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="configuration : UtilizationConfiguration : added&#10;" timestamp="2023-11-02T12:53:45.111Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : DeleteUtilizationRecords : service updated&#10;" timestamp="2023-11-02T14:10:10.372Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetStartEndDates : service updated&#10;" timestamp="2023-11-02T14:12:38.990Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetStartEndDates : service updated&#10;" timestamp="2023-12-07T16:28:37.971Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetStartEndDates : service updated&#10;" timestamp="2023-12-07T19:58:59.202Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : GetStartEndDates : service updated&#10;" timestamp="2023-12-07T21:20:21.245Z" user="Administrator"/></ConfigurationChanges></ThingTemplate><ThingTemplate aspect.isSystemObject="false" baseThingTemplate="PTCSC.Utilization.EntryPoint_TT" description="Implementation of PTCSC&gt;utilization using SQL data objects" documentationContent="" effectiveThingPackage="ConfiguredThing" homeMashup="" inheritedValueStream="" lastModifiedDate="2023-11-01T13:36:32.992Z" name="PTCSC.UtilizationSQLImpl.EntryPoint_TT" projectName="PTCSC.UtilizationSQLImpl" tags="" thingPackage="" valueStream=""><Owner name="Administrator" type="User"/><avatar/><DesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></DesignTimePermissions><RunTimePermissions/><VisibilityPermissions><Visibility><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_OR" type="Organization"/><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_OR:PTCSC.UtilizationSQLImpl.Admin_UG" type="OrganizationalUnit"/></Visibility></VisibilityPermissions><ConfigurationTableDefinitions/><ConfigurationTables><ConfigurationTable dataShapeName="" description="Configuration table to store the components core manager" isMultiRow="true" name="ComponentManager" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="true" baseType="STRING" description="unique identifier for the manager that needs to be configured" name="id" ordinal="1"/><FieldDefinition aspect.isPrimaryKey="false" aspect.thingShape="PTC.Base.CommonManagement_TS" baseType="THINGNAME" description="Name of the Manager Thing to be configured" name="managerThingName" ordinal="2"/></FieldDefinitions></DataShape><Rows/></ConfigurationTable></ConfigurationTables><PropertyBindings/><RemotePropertyBindings/><RemoteServiceBindings/><RemoteEventBindings/><AlertConfigurations/><ThingShape><PropertyDefinitions/><ServiceDefinitions/><EventDefinitions/><ServiceMappings/><ServiceImplementations/><Subscriptions/></ThingShape><ImplementedShapes/><SharedConfigurationTables/><InstanceDesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></InstanceDesignTimePermissions><InstanceRunTimePermissions><Permissions resourceName="*"><PropertyRead/><PropertyWrite/><ServiceInvoke><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Admin_UG" type="Group"/></ServiceInvoke><EventInvoke/><EventSubscribe/></Permissions></InstanceRunTimePermissions><InstanceVisibilityPermissions><Visibility/></InstanceVisibilityPermissions><ConfigurationChanges><ConfigurationChange changeAction="CREATE" changeReason="Created Programmatically" timestamp="2022-11-01T15:09:34.398Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="SetProjectName : [PTCSC.UtilizationSQLImpl]" timestamp="2022-11-01T15:09:34.609Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:24.609Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:24.611Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:34.476Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:34.480Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:40.547Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:40.550Z" user="Administrator"/><ConfigurationChange changeAction="CREATE" changeReason="" timestamp="2023-11-01T13:36:32.992Z" user="Administrator"/></ConfigurationChanges></ThingTemplate></ThingTemplates><ExtensionPackages/><Organizations><Organization description="" documentationContent="" homeMashup="" lastModifiedDate="2023-11-01T13:36:32.941Z" loginButtonStyle="" loginPrompt="" loginResetPassword="false" loginStyle="" mobileMashup="" name="PTCSC.UtilizationSQLImpl.Default_OR" projectName="PTCSC.UtilizationSQLImpl" resetMailContent="&lt;p&gt;[[resetemail.requestmade]]&lt;/p&gt;&lt;p&gt;[[resetemail.instructions]]&lt;/p&gt;&lt;p&gt;[[resetemail.helpneeded]]&lt;/p&gt;" resetMailServer="" resetMailSubject="[[resetemail.subject]]" tags=""><Owner name="Administrator" type="User"/><avatar/><DesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></DesignTimePermissions><RunTimePermissions/><VisibilityPermissions><Visibility><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_OR" type="Organization"/><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_OR:PTCSC.UtilizationSQLImpl.Admin_UG" type="OrganizationalUnit"/></Visibility></VisibilityPermissions><ConfigurationTableDefinitions/><ConfigurationTables/><loginImage/><Connections><Connection from="" to="Root"/><Connection from="Root" to="PTCSC.UtilizationSQLImpl.Admin_UG"/><Connection from="Root" to="PTCSC.UtilizationSQLImpl.Default_UG"/></Connections><OrganizationalUnits><OrganizationalUnit description="" name="PTCSC.UtilizationSQLImpl.Admin_UG"><Members><Members><Member name="PTCSC.UtilizationSQLImpl.Admin_UG" type="Group"/></Members></Members></OrganizationalUnit><OrganizationalUnit description="" name="PTCSC.UtilizationSQLImpl.Default_UG"><Members><Members><Member name="PTCSC.UtilizationSQLImpl.Default_UG" type="Group"/></Members></Members></OrganizationalUnit><OrganizationalUnit description="" name="Root"><Members><Members/></Members></OrganizationalUnit></OrganizationalUnits><ConfigurationChanges><ConfigurationChange changeAction="CREATE" changeReason="Created Programmatically" timestamp="2022-11-01T15:09:34.614Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="SetProjectName : [PTCSC.UtilizationSQLImpl]" timestamp="2022-11-01T15:09:34.655Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:24.592Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:24.596Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:34.452Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:34.456Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:40.525Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:40.528Z" user="Administrator"/><ConfigurationChange changeAction="CREATE" changeReason="" timestamp="2023-11-01T13:36:32.940Z" user="Administrator"/></ConfigurationChanges></Organization></Organizations><Menus/><ThingGroups/><Resources/><DataTags/><ThingShapes><ThingShape aspect.isSystemObject="false" className="" description="Implementation of PTCSC&gt;utilization using SQL data objects" documentationContent="" homeMashup="" lastModifiedDate="2023-11-01T13:36:32.943Z" name="PTCSC.UtilizationSQLImpl.Management_TS" projectName="PTCSC.UtilizationSQLImpl" tags=""><PropertyDefinitions/><ServiceDefinitions/><EventDefinitions/><ServiceMappings/><ServiceImplementations/><Subscriptions/><Owner name="Administrator" type="User"/><avatar/><DesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></DesignTimePermissions><RunTimePermissions/><VisibilityPermissions><Visibility><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_OR" type="Organization"/><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Default_OR:PTCSC.UtilizationSQLImpl.Admin_UG" type="OrganizationalUnit"/></Visibility></VisibilityPermissions><ConfigurationTableDefinitions/><ConfigurationTables/><PropertyBindings/><RemotePropertyBindings/><RemoteServiceBindings/><RemoteEventBindings/><AlertConfigurations/><InstanceRunTimePermissions><Permissions resourceName="*"><PropertyRead/><PropertyWrite/><ServiceInvoke><Principal isPermitted="true" name="PTCSC.UtilizationSQLImpl.Admin_UG" type="Group"/></ServiceInvoke><EventInvoke/><EventSubscribe/></Permissions></InstanceRunTimePermissions><ConfigurationChanges><ConfigurationChange changeAction="CREATE" changeReason="Created Programmatically" timestamp="2022-11-01T15:09:34.546Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="SetProjectName : [PTCSC.UtilizationSQLImpl]" timestamp="2022-11-01T15:09:34.583Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:24.613Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:24.615Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:34.482Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:34.486Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:40.553Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="AddVisibilityPermission" timestamp="2023-02-07T20:21:40.556Z" user="Administrator"/><ConfigurationChange changeAction="CREATE" changeReason="" timestamp="2023-11-01T13:36:32.943Z" user="Administrator"/></ConfigurationChanges></ThingShape></ThingShapes><Subsystems/><NotificationContents/></Entities>